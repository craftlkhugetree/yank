(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0a39482"],{"031a":function(t,e,s){"use strict";s("7b7e")},"2f45":function(t,e,s){"use strict";s("77c1")},"77c1":function(t,e,s){},"7b7e":function(t,e,s){},c713:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"examing"},[s("van-sticky",[s("van-nav-bar",{attrs:{title:"入馆考试","left-arrow":""},on:{"click-left":t.onClickLeft}})],1),s("span",{staticClass:"hh2"},[t._v(t._s(t.curExam.name))]),s("div",{staticClass:"exam-body"},[t.curExam.duration>=0&&t.isExam?s("span",{staticClass:"time-tip"},[t._v(" 剩余时间 "),s("strong",[t._v(t._s(t.common.formatNeedTime(t.lasttime)))])]):t._e(),t.isExam?t._e():s("span",{staticClass:"time-tip"},[t._v(" 答题用时 "),s("strong",[t._v(t._s(t.common.formatNeedTime(t.curExamResult.passedtime)))])]),s("div",{staticClass:"circle",on:{click:function(e){e.stopPropagation(),t.$refs.answerPop.isPopShow=!0}}},[s("div",{staticClass:"block2"},[s("span",{staticClass:"txt5"},[t._v(t._s(t.pageNum||t.doneNum)+" ")]),s("span",{staticClass:"word8"},[t._v("/ "+t._s(t.total<=0?"00":t.total<10?"0"+t.total:t.total))])])]),s("answer-pop",{ref:"answerPop",attrs:{dataList:t.dataList,curTypeIndex:t.curTypeIndex,curIndex:t.curIndex,isExam:t.isExam},on:{choose:t.chooseQuestion}}),s("div",{staticStyle:{padding:"0 10px"}},[s("div",{staticClass:"title"},[s("h3",[t._v(" "+t._s(t.curTypeInfo.typename)+" "),s("span",[t._v("每题"+t._s(t.curTypeInfo.score)+"分")])])]),t.curQuestion&&t.curQuestion.id?s("div",{staticClass:"content"},[s("p",[t._v(t._s(t.pageNum)+". "+t._s(t.curQuestion.subject))]),t._l(t.curQuestion.photoList,(function(e){return s("van-image",{key:e,attrs:{fit:"cover",width:"60%",height:"100",src:e,"preview-src-list":t.curQuestion.photoList},scopedSlots:t._u([{key:"error",fn:function(){return[t._v("图片加载失败")]},proxy:!0}],null,!0)})})),"0"==t.curTypeIndex?s("van-radio-group",{attrs:{disabled:!t.isExam},on:{change:t.doneQuestion},model:{value:t.curQuestion.isTrue,callback:function(e){t.$set(t.curQuestion,"isTrue",e)},expression:"curQuestion.isTrue"}},[s("van-radio",{style:"1"==t.curQuestion.isTrue?{background:"#8289F1"}:"",attrs:{name:1}},[t._v("对")]),s("van-radio",{style:"0"==t.curQuestion.isTrue?{background:"#8289F1"}:"",attrs:{name:0}},[t._v("错")])],1):"1"==t.curTypeIndex?s("van-radio-group",{attrs:{disabled:!t.isExam},on:{change:t.doneQuestion},model:{value:t.curQuestion.chooseOptionId,callback:function(e){t.$set(t.curQuestion,"chooseOptionId",e)},expression:"curQuestion.chooseOptionId"}},t._l(t.curQuestion.options,(function(e){return s("van-radio",{key:e.id,style:e.id===t.chooseOpId[t.pageNum]?{background:"#8289F1"}:"",attrs:{name:e.id}},[t._v(t._s(e.itemInfo))])})),1):s("van-checkbox-group",{attrs:{disabled:!t.isExam},on:{change:t.checkQuestion},model:{value:t.curQuestion.chooseOptionIds,callback:function(e){t.$set(t.curQuestion,"chooseOptionIds",e)},expression:"curQuestion.chooseOptionIds"}},t._l(t.curQuestion.options,(function(e){return s("van-checkbox",{key:e.id,style:t.chooseOpId[t.pageNum]&&t.chooseOpId[t.pageNum].includes&&t.chooseOpId[t.pageNum].includes(e.id)?{background:"#8289F1"}:"",attrs:{shape:"square",name:e.id}},[t._v(t._s(e.itemInfo))])})),1)],2):t._e(),t.isExam?t._e():s("exam-result",{attrs:{curTypeIndex:t.curTypeIndex,curIndex:t.curIndex,dataList:t.dataList}}),s("div",{staticClass:"footer"},[s("div",{staticClass:"right-btn"},[t.curTypeIndex>0||t.curIndex>0?s("van-button",{staticStyle:{width:"150px",float:"left",background:"#ffffff","border-radius":"44px",border:"1px solid #8289f1",margin:"10px 0 50px 0"},attrs:{size:"big",round:""},on:{click:function(e){return e.stopPropagation(),t.goQuestion("pre")}}},[t._v("上一题")]):t._e(),t.curTypeIndex!==t.dataList.length-1||t.curIndex!==t.curTypeInfo.total-1?s("van-button",{staticStyle:{width:"150px",float:"right",margin:"10px 0 50px 0"},attrs:{type:"primary",size:"big",color:"#8289F1",round:""},on:{click:function(e){return e.stopPropagation(),t.goQuestion("next")}}},[t._v("下一题")]):t._e(),t.curTypeIndex==t.dataList.length-1&&t.curIndex==t.curTypeInfo.total-1&&t.isExam?s("van-button",{staticStyle:{width:"150px",float:"right",margin:"10px 0 50px 0"},attrs:{type:"primary",color:"#8289F1",round:"",size:"big"},on:{click:function(e){return e.stopPropagation(),t.wantSubmit.apply(null,arguments)}}},[t._v("我要交卷")]):t._e()],1)])],1)],1),s("confirm",{ref:"confirmSubmit",attrs:{title:"确认交卷？",text:"一旦交卷后便不可再作答和修改答案，确定交卷吗？",cancelText:"取消",confirmText:"确定"},on:{doConfirm:t.submitExam}}),s("confirm",{ref:"submitting",attrs:{title:"",text:t.submittingText,align:"center",showButton:!1}}),s("result",{ref:"pass",attrs:{score:t.score,cancelText:"返回主页",confirmText:"查看考试"},on:{doCancel:function(e){return t.$router.push("/exam")},doConfirm:t.goReview}}),s("result",{ref:"passModel",attrs:{score:t.score,cancelText:"查看考试",confirmText:"学习下一关"},on:{doCancel:t.goReview,doConfirm:t.learnNext}}),s("result",{ref:"nopass",attrs:{type:"fail",score:t.score,cancelText:"查看考试",confirmText:"继续学习"},on:{doCancel:t.goReview,doConfirm:function(e){return t.$router.push("/exam/learn")}}})],1)},i=[],o=(s("d3b7"),s("3ca3"),s("ddb0"),s("4de4"),s("d81d"),s("159b"),s("7db0"),s("ac1f"),s("1276"),s("2f62")),r=s("f564"),a=s("39f0"),u={components:{Confirm:function(){return Promise.resolve().then(s.bind(null,"9420"))},Result:function(){return s.e("chunk-04457918").then(s.bind(null,"c463"))},AnswerPop:function(){return s.e("chunk-65edbf20").then(s.bind(null,"4431"))},ExamResult:function(){return s.e("chunk-17288082").then(s.bind(null,"cb17"))}},data:function(){return{isExam:1,chooseOpId:{},pageNum:1,imgViewUrl:window.g.viewUrl,questions:[],total:0,curTypeIndex:0,curIndex:0,dataList:[{type:"3",typename:"判断题",score:0,total:0,questions:[]},{type:"1",typename:"单选题",score:0,total:0,questions:[]},{type:"2",typename:"多选题",score:0,total:0,questions:[]}],lasttime:0,timer:null,passedtime:0,dialogVisible:!0,dialogTitle:"确认开始考试？",dialogText:"",score:0,submittingText:"交卷完成，成绩计算中…"}},computed:Object(o["b"])({curExam:function(t){return t.curExam},curExamResult:function(t){return t.curExamResult},tbHeight:function(t){return t.tabbarHeight},content:function(){return this.curExam.content},curLearn:function(t){return t.curLearn},curTypeInfo:function(){return this.dataList[this.curTypeIndex]},curQuestion:function(){return this.curTypeInfo.questions[this.curIndex]},doneNum:function(){return this.questions.filter((function(t){return t.done})).length},percent:function(){return parseInt(this.doneNum/this.total*100)||0}}),watch:{lasttime:function(t){t<=0&&this.curExam.duration>0&&(this.submittingText="考试时间结束，自动交卷，成绩计算中…",this.submitExam())}},methods:{goReview:function(){this.isExam=0,this.curTypeIndex=0,this.curIndex=0,this.pageNum=1,this.stickTop()},onClickLeft:function(){this.$router.go(-1)},stickTop:function(){var t=document.getElementsByTagName("html");t&&t[0]&&(t[0].scrollTop=0)},chooseQuestion:function(t,e,s){this.curTypeIndex=t,this.curIndex=e,this.pageNum=s,this.$refs.answerPop.isPopShow=!1},goQuestion:function(t){this.stickTop(),"pre"==t&&(0==this.curIndex&&this.curTypeIndex>0?(this.curTypeIndex-=1,this.curIndex=this.curTypeInfo.total-1):this.curIndex-=1,this.pageNum&&this.pageNum--),"next"==t&&(this.curIndex==this.curTypeInfo.total-1&&this.curTypeIndex<this.dataList.length-1?(this.curTypeIndex+=1,this.curIndex=0):this.curIndex+=1,this.pageNum++)},doneQuestion:function(t){(t||0===t)&&(this.chooseOpId[this.pageNum]=t,this.curQuestion.done=!0)},checkQuestion:function(t){this.chooseOpId[this.pageNum]=t,this.curQuestion.done=t.length>0},wantSubmit:function(){var t=60*this.curExam.beforeSubmitTime;if(t&&this.passedtime<t){var e="考试开始".concat(this.curExam.beforeSubmitTime,"分钟后方可交卷！");Object(r["a"])({type:"warning",message:e})}else this.$refs.confirmSubmit.visible=!0},submitExam:function(){var t=this;clearInterval(this.timer),this.$refs.confirmSubmit.visible=!1;var e=this.$refs.submitting;e.visible=!0;var s=this.questions.map((function(t){return{id:t.id,type:t.type,isTrue:t.isTrue,chooseOptionIds:"1"==t.type?[t.chooseOptionId]:t.chooseOptionIds}})),n={examId:this.curExam.id,agent:"2",questions:s},i=a["g"];"2"==this.curExam.type&&(n.modelId=this.content.modelId,i=a["h"]),i(n).then((function(s){if(e.visible=!1,"000000"==s.code){var n=s.data||{};t.score=n.userScore,n.isPass||n.isPassAll?t.$refs.pass.visible=!0:!n.isPassAll&&n.isPassCurrent?t.$refs.passModel.visible=!0:t.$refs.nopass.visible=!0,t.setExamResult(n)}else{var i="交卷失败："+s.msg;Object(r["a"])({type:"warning",message:i})}})).catch((function(t){e.visible=!1;var s="交卷失败："+t;Object(r["a"])({type:"warning",message:s})}))},setExamResult:function(t){var e=t.resultQuesions;this.dataList.forEach((function(t){t.questions.forEach((function(t){var s=e.find((function(e){return e.id==t.id}));t.answerResult=s.answerResult,t.trueOptionIds=s.trueOptionIds,t.analysis=s.analysis}))})),this.$store.commit("setCurExamResult",{isPass:t.isPass,score:t.userScore,totalNum:this.total,passNum:e.filter((function(t){return t.answerResult})).length,wrongNum:e.filter((function(t){return!t.answerResult})).length,passedtime:this.passedtime,dataList:this.dataList})},learnNext:function(){this.$store.commit("setCurLearn",{modelIndex:this.curLearn.modelIndex+1,learnIndex:0}),this.$router.push("/exam/learn")},getExamQuestion:function(){var t=this;Object(a["a"])({examId:this.curExam.id,modelId:"1"==this.curExam.type?null:this.content.modelId}).then((function(e){if("000000"==e.code)t.questions=e.data||[],t.total=t.questions.length,t.setQuestions();else{t.questions=[],t.total=0;var s="获取试题失败："+e.msg;Object(r["a"])({type:"warning",message:s})}})).catch((function(e){t.questions=[],t.total=0;var s="获取试题失败："+e;Object(r["a"])({type:"warning",message:s})}))},setQuestions:function(){var t=this;this.dataList.forEach((function(e){e.questions=t.questions.filter((function(t){return t.type==e.type})),e.questions.forEach((function(e){t.$set(e,"done",!1),e.photoList=e.photos?e.photos.split(",").map((function(e){return e&&t.imgViewUrl+e})):[],"1"==e.type&&t.$set(e,"chooseOptionId",""),"2"==e.type&&t.$set(e,"chooseOptionIds",[])}))}))},initDataList:function(){var t=this.content,e=t.judgeNum,s=t.judgeScore,n=t.singleNum,i=t.singleScore,o=t.multipleNum,r=t.multipleScore;this.dataList.forEach((function(t){switch(t.type){case"3":t.total=e,t.score=s;break;case"1":t.total=n,t.score=i;break;case"2":t.total=o,t.score=r;break}})),this.dataList=this.dataList.filter((function(t){return t.total>0}))},setTime:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.lasttime-=1,t.passedtime+=1}),1e3)}},beforeDestroy:function(){clearInterval(this.timer)},created:function(){this.initDataList(),this.getExamQuestion(),this.lasttime=60*this.curExam.duration||1800,this.setTime()}},c=u,l=(s("2f45"),s("031a"),s("2877")),d=Object(l["a"])(c,n,i,!1,null,"906deea0",null);e["default"]=d.exports}}]);