(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2eb3201c"],{"57e8":function(e,n,t){"use strict";t("f4ec")},"635f":function(e,n,t){"use strict";t.r(n);var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"page"},[t("van-sticky",[t("div",{staticClass:"model"},[t("van-nav-bar",{attrs:{title:"入馆考试","left-arrow":""},on:{"click-left":e.onClickLeft}}),t("model-step",{attrs:{list:e.examLearnData,exam:e.curExam},on:{doFunc:e.getLoginUserRecords}})],1)]),t("div",{staticClass:"card"},[t("card-step",{attrs:{list:e.examLearnData[e.curLearn.modelIndex].learns,modelIndex:e.curLearn.modelIndex},on:{getRecords:e.getLoginUserRecords}})],1)],1)},i=[],a=t("5530"),o=(t("d3b7"),t("3ca3"),t("ddb0"),t("7db0"),t("4de4"),t("ac1f"),t("1276"),t("159b"),t("caad"),t("2532"),t("2f62")),c=t("39f0"),s={name:"examLearn",components:{ModelStep:function(){return t.e("chunk-23e300b0").then(t.bind(null,"d334"))},CardStep:function(){return t.e("chunk-8ccd39b0").then(t.bind(null,"3f64"))}},data:function(){return{modelId:null,learnId:null,fileViewUrl:window.g.fileViewUrl,imgViewUrl:window.g.viewUrl,timer:null,learnTimes:0,nowLearnTime:0,nowTimer:null,lastNeedLearn:0,records:[],loading:!1,sH:"auto"}},computed:Object(o["b"])({curExam:function(e){return e.curExam},examLearnData:function(e){return e.examLearnData},curLearn:function(e){return e.curLearn},curModel:function(){return this.examLearnData[this.curLearn.modelIndex]},modelLearnList:function(){return this.curModel.learns},detail:function(){var e=this.modelLearnList[this.curLearn.learnIndex];return e}}),methods:{onClickLeft:function(){this.$router.go(-1)},toExam:function(){var e=this,n=this.curExam,t="2"==n.type?n.contents.find((function(n){return n.modelId==e.curModel.id})):n.contents[0];this.$store.commit("setCurExam",Object(a["a"])(Object(a["a"])({},n),{},{content:t})),this.$router.push("/exam/examing")},changeLearn:function(e){this.$store.commit("setCurLearn",{modelIndex:this.curLearn.modelIndex,learnIndex:e}),this.getLoginUserRecords()},getLoginUserRecords:function(){var e=this;return this.loading=!0,Object(c["e"])().then((function(n){if(e.loading=!1,"000000"==n.code){var t=n.data||[];return e.records=t,e.setLastNeedLearn(),Promise.resolve(t)}return Promise.reject(n.msg)})).catch((function(n){return e.loading=!1,Promise.reject(n)}))},setLastNeedLearn:function(){var e=this,n=0;if("1"==this.curExam.type&&(this.nowLearnTime=this.records.reduce((function(e,n){return e+60*n.duration}),0),n=60*this.curExam.needLearn-this.nowLearnTime),"2"==this.curExam.type){var t=this.records.filter((function(n){var t=n.modelIds||[];return"string"===typeof t&&(t=t.split(",")),t.forEach((function(e,n){t[n]=e+""})),t.includes(e.curModel.id+"")}));this.nowLearnTime=this.curModel.learnTimes=t.reduce((function(e,n){return e+60*n.duration}),0),n=60*this.curModel.needLearn-this.nowLearnTime}this.lastNeedLearn=n>0?n:0,this.$store.commit("setTime",{now:this.nowLearnTime,need:this.lastNeedLearn})}},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.nowTimer)},created:function(){this.getLoginUserRecords()}},u=s,d=(t("57e8"),t("2877")),l=Object(d["a"])(u,r,i,!1,null,"7308d2f8",null);n["default"]=l.exports},f4ec:function(e,n,t){}}]);