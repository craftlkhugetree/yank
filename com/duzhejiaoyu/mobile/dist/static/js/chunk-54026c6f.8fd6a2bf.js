(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54026c6f"],{"3d79":function(e,t,n){},9343:function(e,t,n){"use strict";n("3d79")},e8ef:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page"},[n("van-sticky",[n("van-nav-bar",{attrs:{title:"入馆考试","left-arrow":""},on:{"click-left":e.onClickLeft}})],1),n("div",{staticClass:"section4",on:{click:e.toLearnId}},[e._m(0)]),n("div",{staticClass:"learn-content"},[n("div",{staticClass:"content-left"},[n("h3",[e._v(e._s(e.detail.name))]),n("p",{staticClass:"sub"},[e._v(" "+e._s(e.detail.watchCount)+"阅读 · "+e._s(e.detail.downloadCount)+"下载 ")]),e.detail.id?n("div",{staticClass:"video-box"},["1"==e.detail.type?n("video",{ref:"video",attrs:{controls:"",src:e.fileViewUrl+e.detail.id}},[e._v(" 您的浏览器不支持HTML5 video标签 ")]):e._e(),"2"==e.detail.type?n("iframe",{ref:"pdf",attrs:{src:e.fileViewUrl+e.detail.id,width:"100%",height:"450px"}}):e._e()]):e._e(),n("div",{staticClass:"desc-box"},[n("img",{attrs:{src:e.imgViewUrl+e.detail.cover,alt:""}}),n("div",{staticClass:"desc"},[e._v(e._s(e.detail.desc))])]),"3"==e.detail.type?n("div",{staticClass:"dhtml",domProps:{innerHTML:e._s(e.detail.dhtml)}}):e._e()]),n("div",{staticClass:"content-right"},[n("div",{staticClass:"learn-list"},[n("h3",[e._v("接下来学习")]),n("ul",e._l(e.modelLearnList,(function(t,i){return n("li",{key:i,class:{active:t.id==e.detail.id},on:{click:function(t){return e.changeLearn(i)}}},[n("i",{class:"iconfont icon-learn-"+t.type}),n("span",{staticClass:"title ellipsis"},[e._v(e._s(t.name)+" "),3!=t.type?n("span",{staticClass:"size"},[e._v(e._s(e.common.learnSizeFormat(t.fileSize)))]):e._e()]),n("p",{staticClass:"ellipsis"},[e._v(e._s(t.desc))])])})),0)])])])],1)},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"infoBox2"},[e._v("学"),n("br"),e._v("习"),n("br"),e._v("更"),n("br"),e._v("多")])}],a=n("5530"),s=(n("7db0"),n("d3b7"),n("4de4"),n("caad"),n("2532"),n("2f62")),o=n("39f0"),c={name:"examLearnId",data:function(){return{modelId:null,learnId:null,fileViewUrl:window.g.fileViewUrl,imgViewUrl:window.g.viewUrl,timer:null,learnTimes:0,nowLearnTime:0,nowTimer:null,lastNeedLearn:0,records:[],loading:!1}},computed:Object(s["b"])({curExam:function(e){return e.curExam},examLearnData:function(e){return e.examLearnData},curLearn:function(e){return e.curLearn},curModel:function(){return this.examLearnData[this.curLearn.modelIndex]},modelLearnList:function(){return this.curModel.learns},detail:function(){var e=this.modelLearnList[this.curLearn.learnIndex];return e}}),methods:{onClickLeft:function(){this.$router.go(-1)},toLearnId:function(){this.$store.commit("setCurLearn",{modelIndex:this.curLearn.modelIndex,learnIndex:0}),this.$router.push("/exam/learn")},toExam:function(){var e=this,t=this.curExam,n="2"==t.type?t.contents.find((function(t){return t.modelId==e.curModel.id})):t.contents[0];this.$store.commit("setCurExam",Object(a["a"])(Object(a["a"])({},t),{},{content:n})),this.$router.push("/exam/examing")},startLearn:function(e){Object(o["f"])({id:e}),clearInterval(this.timer),this.timer=setInterval((function(){Object(o["f"])({id:e})}),6e4)},changeLearn:function(e){this.$store.commit("setCurLearn",{modelIndex:this.curLearn.modelIndex,learnIndex:e}),this.startLearn(this.modelLearnList[e].id),this.getLoginUserRecords()},getLoginUserRecords:function(){var e=this;return this.loading=!0,Object(o["e"])().then((function(t){if(e.loading=!1,"000000"==t.code){var n=t.data||[];return e.records=n,e.setLastNeedLearn(),Promise.resolve(n)}return Promise.reject(t.msg)})).catch((function(t){return e.loading=!1,Promise.reject(t)}))},setLastNeedLearn:function(){var e=this,t=0;if("1"==this.curExam.type&&(this.nowLearnTime=this.records.reduce((function(e,t){return e+60*t.duration}),0),t=60*this.curExam.needLearn-this.nowLearnTime),"2"==this.curExam.type){var n=this.records.filter((function(t){return t.modelIds.includes(e.curModel.id)}));this.nowLearnTime=this.curModel.learnTimes=n.reduce((function(e,t){return e+60*t.duration}),0),t=60*this.curModel.needLearn-this.nowLearnTime}this.lastNeedLearn=t>0?t:0,clearInterval(this.nowTimer),this.nowTimer=setInterval((function(){e.nowLearnTime+=1,e.lastNeedLearn=e.lastNeedLearn>0?e.lastNeedLearn-1:0,e.$store.commit("setTime",{now:e.nowLearnTime,need:e.lastNeedLearn})}),1e3)}},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.nowTimer)},created:function(){this.getLoginUserRecords(),this.startLearn(this.detail.id)}},l=c,d=(n("9343"),n("2877")),u=Object(d["a"])(l,i,r,!1,null,"c28d574e",null);t["default"]=u.exports}}]);