(function(e){function t(t){for(var s,n,r=t[0],l=t[1],c=t[2],d=0,p=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(s=!1)}s&&(o.splice(t--,1),e=n(n.s=a[0]))}return e}var s={},i={app:0},o=[];function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=s,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/lres2022/control/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0027":function(e,t,a){},"016a":function(e,t,a){"use strict";a("2c82")},"026d":function(e,t,a){},"0537":function(e,t,a){"use strict";a("7316")},"073f":function(e,t,a){},"0a7c":function(e,t,a){},"0c37":function(e,t,a){"use strict";a("073f")},"0ebd":function(e,t,a){},1053:function(e,t,a){"use strict";a("0a7c")},1129:function(e,t,a){},"122e":function(e,t,a){"use strict";a("756a")},"144b":function(e,t,a){},"18c9":function(e,t,a){},1997:function(e,t,a){"use strict";a("be65")},"1c8b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAAXNSR0IArs4c6QAAA3NJREFUWEfVmVvITVsUx3//3BJJKeXBi1skKRJ5cEJSQnKJ0smdknNecfDg9rm9uKWIc5QXhRJPJ0kJ5Zry4EFKFFFKCuU2NLa52d/+1l5rzrW/tM3atWuPy2/NucdljiWaXGbWHRgcPv2BXsHkO+AV8Ng/kj4240pllM2sHzAHmAaMA3oW2PkA3AYuAeclvU71mwRqZkOBv4HZQLdUZ0H+E3ABOCjpUayNKFAz6wNsAP4EusQaL5D7ApwCdkt6W2SzENTMxgNHgAFFxkr+/gJYK+lmnn4uqJn5Du4EupaEiFX7DGyS5DucuRqCmtk64J9YT50k1ybpcJatTNCwk3s6yXmqmfVZO9sBNPwnz/yC4270AP43WFD/n20HGqL7SonAMcCD4VpI8h7R9WsUsDRyez3AJtdmg3rQtgRjVZ/PgTWS7uZBmNkM4HgkqIudlPQjRn6Amtkw4HJinnwCzJfksLmrBKifypRqUagFPQTMK3JY9/scSbdidEqAutlzkv7yLxXQULvvJZbFO5K8lEatkqBebsd4b1AFXQFsj/L4U+iApOgUVhLUvW2RdKIKehqYlAhaMRCrY2azgKOx8jVyVyUtUugnH0a0avU+9kvaG+vYzFYBW2Pla+S8RRzhoCNCtKfauCXJe9KoZWb/AdOjhDsKTXXQmcCxEgY8yc8t6npCsA4Jm1G2h13toMuBHSVAXeWZ75KkN430zaw34CV5dEkfrrbZQT1PbWzCiCd97yfv19sws+HAAcDLZzNrV2eAVk4XuA7cCLW+LzAR+COx0jV6mApoM0ffzC6l6FaOvmwwpThqVrYSTKnpya+63ry8DEeeAuFXmkHewgE9EhQr6ckHCLEJ/6zfRiW9T3DSQdTMBgL/AiMj7HxP+CHPxZRQ75I8b36NMF4oYmY+VbkK+FU8b30voQE0pilZJun/QoIEATPz/O3BnLfaNSU+oilq8yZIeprAUShqZouBfTmC7du8sKtFjbNXoAeF3hMEzGytV50clfaNcwAtuook9Z8xvGZ2ERjbQDb7KhJg8y53Hn3zskplDFS9jJmtBLbl6GZf7gKoR2DeddnTkk8yfBrXTB5dAizMgcy/LgdYH4q19gCi+oS/xUinBrb1h2R1O9vaY8ca2NYf5NbAtv5ovDaFtPzLhoxk3dqvb7IS9K96IfYNDAVgsJiN/i4AAAAASUVORK5CYII="},"1f7d":function(e,t,a){"use strict";a("fa2e")},"1fad":function(e,t,a){"use strict";a("6dd6")},2601:function(e,t,a){"use strict";a("0027")},"2c82":function(e,t,a){},3071:function(e,t,a){"use strict";a("0ebd")},"34c4":function(e,t,a){},"34f9":function(e,t,a){"use strict";a("8fad")},3814:function(e,t,a){},"39cc":function(e,t,a){e.exports=a.p+"static/img/logo-white.5606e4c3.png"},"3b00":function(e,t,a){},4126:function(e,t,a){"use strict";a("6441")},4678:function(e,t,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(e){var t=o(e);return a(t)}function o(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}i.keys=function(){return Object.keys(s)},i.resolve=o,e.exports=i,i.id="4678"},"542e":function(e,t,a){"use strict";a("f824")},5641:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s,i=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("transition",{attrs:{name:"el-fade-in-linear",mode:"out-in"}},[a("router-view")],1)],1)},n=[],r=(a("d3b7"),a("caad"),a("2532"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("fb6a"),a("99af"),a("a15b"),a("a9e3"),a("841c"),a("1276"),"http://seat.dev.angke.cn/appportalweb/rest/"),l="",c="/appportalweb",u="production";"development"===u?s=1:"test"===u?s=2:"production"===u&&(s=3);var d=function(){if(1===s)return r;if(2===s)return"http://app.dev.angke.com.cn/appportalweb/rest/";if(3===s){var e=document.location.pathname,t=e.substring(0,e.substr(1).indexOf("/")+1),a=location.protocol+"//"+location.host+t;return a+"/rest/"}throw"项目状态输入错误！"},p=function(){if(1===s)return"/fileweb/rest/FileOut/view";if(2===s)return"/fileweb/rest/FileOut/view";if(3===s)return"".concat(location.protocol,"//").concat(location.host,"/fileweb/rest/FileOut/view/");throw"项目状态输入错误！"},m=function(e){if(e)return e;var t=window.document.location.pathname;""===c&&(c=t.substring(0,t.substr(1).indexOf("/")+1));var a=c+"/",s=document.location.href.split("#")[0];return a+"rest/Idsclient/reqLogin?reqUrl="+encodeURIComponent(s)},f=function(){if(1===s)return l;if(2===s||3===s)return m(l);throw"项目状态输入错误！"},h=function(){if(1===s)return"http://file.dev.angke.com.cn/fileweb/rest/FileOut/saveFile";if(2===s)return"http://file.dev.angke.com.cn/fileweb/rest/FileOut/saveFile";if(3===s)return"".concat(location.protocol,"//").concat(location.host,"/fileweb/rest/FileOut/saveFile/");throw"项目状态输入错误！"},g=function(e){var t=document.createElement("div"),a={position:"fixed",top:"50%",width:"100%"};for(var s in a)t.style[s]=a[s];var i=document.createElement("sapn");i.innerText=e;var o={"background-color":"rgba(0,0,0,0.5)",padding:"15px 15px","border-radius":"5px",color:"#FFF",margin:"0 auto","font-size":"1rem"};for(var n in o)i.style[n]=o[n];t.appendChild(i);var r=document.getElementsByTagName("body")[0];r.appendChild(t),setTimeout((function(){r.removeChild(t)}),3e3)},b={getReadFile:p(),getLoginUrl:f(),getUploadUrl:h(),getAppportalwebUrl:d(),tips:function(e){return g(e)}},v=a("bc3a"),w=a.n(v),y=a("4328"),x=a.n(y),C=w.a;w.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";var k={url:{}};k.url["url"]=window.g.url,k.url["appportal"]=window.g.appportalUrl,k.url["auth"]=window.g.authUrl,k.url["file"]=window.g.fileUrl,k.url["idsweb"]=window.g.idsUrl,k.url["third"]=window.g.thirdUrl;var S=function(e,t){return new Promise((function(a,s){var i=!!k.url[e]&&k.url[e];i?a(k.url[e]+t):F({code:"appportal",url:"Portal/getPhyAppByCODEs",data:{CODEs:JSON.stringify([e])}}).then((function(i){var o=i;if(o.success){for(var n=0;n<o.data.length;n++)k.url[o.data[n].CODE]=o.data[n].URL;a(k.url[e]+t)}else s("fail!"),b.tips("获取Url失败！");a(k.url[e]+t)})).catch((function(e){s("fail!"),s(e)}))}))},F=function(e){return new Promise((function(t,a){e&&e.url&&e.code?S(e.code,e.url).then((function(s){var i={url:s,method:e.isGet?"GET":"POST",headers:{IDSTGC:T("IDSTGC")||"a756cc42a1b5456ba88a62af0faf8135"},data:e.isRep?e.data:x.a.stringify(e.data)||""};return C(i).then((function(e){var a=e,s=e.data;!1===s.login||"string"===typeof s&&s.includes("<html>")?j():!1===s.success?t(a):t(s)})).catch((function(e){var t=D();t&&j(),a(e)}))})).catch((function(e){a(e)})):(a("参数错误！"),b.tips("参数错误！"))}))},L=function(e,t,a,s,i){C({url:window.g.url+e,method:t?"GET":"POST",responseType:"blob",headers:{IDSTGC:T("IDSTGC")||"4c94867cb4854ede8ce3121f4a2a037e"},data:a}).then((function(e){var t=window.URL.createObjectURL(e.data),a=document.createElement("a");a.href=t,a.style.display="none",a.setAttribute("download",s+"."+i),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)}))},D=function(){var e=navigator.userAgent,t=e.indexOf("Edge")>-1,a=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,s=e.indexOf("MSIE")>-1;return t||a||s},T=function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},j=function(){location.href=b.getLoginUrl},$=function(e,t){var a,s=""+e,i=function(e){return e>=10?e:"0"+e};switch(s.length){case 17:case 16:case 15:case 14:a=new Date(parseInt(s.substring(0,4)),parseInt(s.substring(4,6))-1,parseInt(s.substring(6,8)),parseInt(s.substring(8,10)),parseInt(s.substring(10,12)),parseInt(s.substring(12,14)));break;case 13:a=new Date(e);break;case 8:a=new Date(parseInt(s.substring(0,4)),parseInt(s.substring(4,6))-1,parseInt(s.substring(6,8)));break;default:a="",console.log("format参数输入错误")}var o="";return o=a?t.replace(/YYYY/gi,a.getFullYear()+"").replace(/MM/g,i(a.getMonth()+1)).replace(/DD/gi,i(a.getDate())).replace(/hh/gi,i(a.getHours())).replace(/mm/g,i(a.getMinutes())).replace(/ss/gi,i(a.getSeconds())):"--",o},I=function(){var e=new Date,t=e.getMonth()+1;t>=1&&t<=9&&(t="0"+t);var a=e.getDate();a>=0&&a<=9&&(a="0"+a);var s=e.getHours();s>=0&&s<=9&&(s="0"+s);var i=e.getMinutes();return i>=0&&i<=9&&(i="0"+i),e.getFullYear()+t+a},z=function(e){return e.slice(0,4)-e.slice(4,6)-e.slice(6,8)},N=function(e){if("number"!==typeof parseInt(e))throw"Ow<这是一条来自common的提示：传入的参数类型不正确，需要一个数字/数字字符串";e=parseInt(e);var t=function(e){return e>=10?e:"0"+e},a=parseInt(e%60),s=parseInt(e/3600),i=parseInt((e-3600*s)/60);return"".concat(t(s),":").concat(t(i),":").concat(t(a))},A=function(e){return e.charAt(0)+Array(e.length).join("*")},P={global:k,exportFile:L,formatMYD:function(){return I()},slicetime:function(){return z()},angle:function(e){return 180*Math.atan(e)/Math.PI},GenNonDuplicateID:function(){return Number(Math.random().toString().substr(3,8)+Date.now()).toString(36)},formatmintomins:function(e){return Math.floor(e/60)+"分"+e%60+"秒"},dist:function(e,t){return Math.sqrt(e*e+t*t)},formatTime:function(e,t){return $(e,t)},postAjax:function(e){return F(e)},getUrlByCode:function(e,t){return S(e,t)},getCookieByName:function(e){return T(e)},getUrlParam:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?decodeURI(a[2]):""},formatSeconds:function(e){return N(e)},formatName:function(e){return A(e)},utf16Str:function(e){for(var t=[],a=0;a<e.length;a++){var s=e.charCodeAt(a);s>=0&&s<=127?(1,t.push(s)):s>=128&&s<=2047?(2,t.push(192|31&s>>6),t.push(128|63&s)):s>=2048&&s<=55295||s>=57344&&s<=65535?(3,t.push(224|15&s>>12),t.push(128|63&s>>6),t.push(128|63&s)):s>=65536&&s<=1114111&&(4,t.push(240|7&s>>18),t.push(128|63&s>>12),t.push(128|63&s>>6),t.push(128|63&s))}return t},regExps:{chinese:/^[\u4e00-\u9fa5]{0,}$/,email:/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/,account:/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/,pwd:/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/,url:/^[http|ftp|https]:\/\/(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\S*)?$/,qq:/^[1-9]\d{4,9}$/,phone:/^((0\d{2,3}-\d{7,8})|(1[358479]\d{9})|(\d{8}))$/,yphone:/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/,floatNum:/^([1-9]\d{0,3}?(\.\d{1,2})?|0|0\.\d{1,2})$/,num:/^([1-9][0-9]*)+(.[0-9]{1,2})?$/,znum:/^[1-9]\d*$/,isbn:/^(\d[- ]*){12}[\dxX]$/,idCard_15:/^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}$/,idCard_18:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,idCard:/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}$)/,URL:"rest",PREURL:""}},O=(a("4e82"),a("2f62")),E=a("0e44");function U(e){return P.postAjax({code:"url",url:"model/list",isRep:!0,data:e})}function q(e){return P.postAjax({code:"url",url:"model/save",isRep:!0,data:e})}function R(e){return P.postAjax({code:"url",url:"model/delete/".concat(e),isGet:!0})}function M(e){return P.postAjax({code:"url",url:"model/up",data:e})}function B(e){return P.postAjax({code:"url",url:"model/down",data:e})}function Y(e){return P.postAjax({code:"url",url:"campus/list",isRep:!0,data:e})}function G(e){return P.postAjax({code:"url",url:"campus/save",isRep:!0,data:e})}function Q(e){return P.postAjax({code:"url",url:"campus/delete/".concat(e),isGet:!0})}function V(){return P.postAjax({code:"url",url:"usertype/syncUsertype"})}function J(e){return P.postAjax({code:"url",url:"usertype/list",isRep:!0,data:e})}function H(e){return P.postAjax({code:"url",url:"config/list",isRep:!0,data:e})}function K(e){return P.postAjax({code:"url",url:"config/save",isRep:!0,data:e})}function X(e){return P.postAjax({code:"url",url:"user/pageQuery",isRep:!0,data:e})}function W(){return P.postAjax({code:"url",url:"user/userGrades",isGet:!0})}function Z(){return P.postAjax({code:"url",url:"user/userDepts",isGet:!0})}function ee(e){return P.postAjax({code:"url",url:"user/activeUsers",isRep:!0,data:e})}function te(e){return P.postAjax({code:"url",url:"user/examRecords",isRep:!0,data:e})}i["default"].use(O["a"]);var ae=new O["a"].Store({state:{appId:"20220216",adminRoleId:"110002",newbornLogin:null,userInfo:{},userStatusList:[{label:"注销",value:"0"},{label:"正常",value:"1"},{label:"挂失",value:"2"},{label:"停借",value:"3"}],gradeList:[],deptList:[],moduleList:[],campusList:[],userTypeList:[],trainTypeList:[{label:"视频",value:"1"},{label:"文档",value:"2"},{label:"在线文章",value:"3"}],qType:"3",questionTypeList:[{label:"判断题",value:"3"},{label:"单选题",value:"1"},{label:"多选题",value:"2"}],examTypeList:[{label:"普通考试",value:"1"},{label:"闯关考试",value:"2"}]},getters:{},mutations:{setUserInfo:function(e,t){e.userInfo=t},setGradeList:function(e,t){e.gradeList=t},setDeptList:function(e,t){e.deptList=t},setNewbornLogin:function(e,t){e.newbornLogin=t},setModuleList:function(e,t){e.moduleList=t},setCampusList:function(e,t){e.campusList=t},setUserTypeList:function(e,t){e.userTypeList=t},setQType:function(e,t){e.qType=t}},actions:{getModuleList:function(e){var t=e.commit;return new Promise((function(e,a){U({}).then((function(s){if("000000"==s.code){var i=s.data||[];i.sort((function(e,t){return e.level>t.level?1:-1})),t("setModuleList",i),e(i)}else a(s.msg)})).catch((function(e){a(e)}))}))},getCampusList:function(e){var t=e.commit;return new Promise((function(e,a){Y({}).then((function(s){if("000000"==s.code){var i=s.data||[];t("setCampusList",i),e(i)}else a(s.msg)})).catch((function(e){a(e)}))}))},getUserTypeList:function(e){var t=e.commit;return new Promise((function(e,a){J({}).then((function(s){if("000000"==s.code){var i=s.data||[];t("setUserTypeList",i),e(i)}else a(s.msg)})).catch((function(e){a(e)}))}))},getGradeList:function(e){var t=e.commit;return new Promise((function(e,a){W({}).then((function(s){if("000000"==s.code){var i=s.data||[];t("setGradeList",i),e(i)}else a(s.msg)})).catch((function(e){a(e)}))}))},getDeptList:function(e){var t=e.commit;return new Promise((function(e,a){Z({}).then((function(s){if("000000"==s.code){var i=s.data||[];t("setDeptList",i),e(i)}else a(s.msg)})).catch((function(e){a(e)}))}))}},modules:{},plugins:[Object(E["a"])({storage:window.sessionStorage})]});function se(){return P.postAjax({code:"auth",url:"rest/User/userDetail"})}function ie(){return P.postAjax({code:"appportal",url:"rest/Portal/getUserMenu",data:{menupid:ae.state.appId}})}var oe={name:"App",computed:Object(O["b"])({userInfo:function(e){return e.userInfo}}),created:function(){var e=this;this.userInfo.ID||se().then((function(t){if(t.success){var a=t.item||{};e.$store.commit("setUserInfo",a)}}))}},ne=oe,re=(a("5c0b"),a("2877")),le=Object(re["a"])(ne,o,n,!1,null,null,null),ce=le.exports,ue=a("8c4f"),de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"app-wrapper"},[a("el-header",{attrs:{height:"80px"}},[a("header-bar")],1),a("el-container",{staticClass:"main-container"},[a("el-aside",{attrs:{width:"200px"}},[a("side-bar",{ref:"sideBar"})],1),a("el-main",{class:{"no-bg":e.noBg}},[a("transition",{attrs:{name:"el-fade-in-linear",mode:"out-in"}},[a("router-view")],1)],1)],1)],1)},pe=[],me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"header"},[s("img",{staticClass:"logo",attrs:{src:a("39cc"),alt:""}}),s("div",{staticClass:"header-right"},[s("el-dropdown",{on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[s("img",{attrs:{src:a("1c8b"),alt:"头像"}}),s("span",[e._v("Hi，"+e._s(e.userInfo.NAME))]),s("i",{staticClass:"el-icon-caret-bottom"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"exit"}},[s("i",{staticClass:"el-icon-switch-button"}),e._v(" 退出登录 ")])],1)],1)],1)])},fe=[],he={computed:{userInfo:function(){return this.$store.state.userInfo}},methods:{handleCommand:function(e){"exit"===e&&this.exit()},exit:function(){sessionStorage.clear(),location.href=location.protocol+"//"+location.host+"/appportalweb/rest/Idsclient/reqLogout?reqUrl="+window.location.href}}},ge=he,be=(a("4126"),Object(re["a"])(ge,me,fe,!1,null,"28c6e6ac",null)),ve=be.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"default-active":e.$route.path,"text-color":"#6e7384","active-text-color":"#3f86f7","active-background-color":"#1B2032",router:""}},[e._l(e.menuData,(function(t){return["0"==t.ISLEAF?a("el-submenu",{key:t.ID,attrs:{index:t.ID}},[a("template",{slot:"title"},[a("i",{staticClass:"iconfont",class:t.ICONCLS,staticStyle:{"padding-left":"12px"}}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.NAME))])]),e._l(t.children,(function(t){return a("el-menu-item",{key:t.ID,class:{"is-active":e.$route.path.includes(t.DISPLAYURL)},attrs:{index:t.DISPLAYURL}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.NAME))])])}))],2):a("el-menu-item",{key:t.ID,staticStyle:{"padding-left":"30px"},attrs:{index:t.DISPLAYURL}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont",class:t.ICONCLS}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.NAME))])])])]}))],2)},ye=[],xe=a("ade3"),Ce=(a("159b"),{data:function(){return Object(xe["a"])({loading:!1,menuData:[],urls:[]},"menuData",[])},watch:{urls:function(){this.redirect()},"$route.path":function(){this.redirect()}},methods:{redirect:function(){var e=this;this.urls.length>0?this.urls.some((function(t){return e.$route.path.includes(t)}))||this.$router.push(this.urls[0]):this.$router.push("/no-right")},getUserMenu:function(){var e=this;this.loading=!0,ie().then((function(t){e.loading=!1,e.menuData=t||[],e.urls=[],e.menuData.forEach((function(t){"1"==t.ISLEAF?e.urls.push(t.DISPLAYURL):t.children.forEach((function(t){e.urls.push(t.DISPLAYURL)}))}))})).catch((function(t){e.loading=!1}))}},created:function(){this.getUserMenu()}}),ke=Ce,Se=(a("a1d2"),Object(re["a"])(ke,we,ye,!1,null,"8ad539c8",null)),_e=Se.exports,Fe={components:{HeaderBar:ve,SideBar:_e},computed:{noBg:function(){return this.$route.meta.noBg||!1}}},Le=Fe,De=(a("2601"),Object(re["a"])(Le,de,pe,!1,null,"18bb20d2",null)),Te=De.exports,je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("error-info",{attrs:{imgUrl:e.imgUrl,errText:e.errText}})},$e=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"app-wrapper"},[a("el-header",{attrs:{height:"80px"}},[a("header-bar")],1),a("el-main",[a("img",{attrs:{src:e.imgUrl,alt:""}}),a("p",[e._v(e._s(e.errText)+" "),a("router-link",{attrs:{to:"/"}},[e._v(" 返回首页")])],1)])],1)},ze=[],Ne={components:{HeaderBar:ve},props:{imgUrl:String,errText:String}},Ae=Ne,Pe=(a("b0c3"),Object(re["a"])(Ae,Ie,ze,!1,null,"60a69cf0",null)),Oe=Pe.exports,Ee={components:{ErrorInfo:Oe},data:function(){return{imgUrl:a("7125"),errText:"抱歉，没有找到您想要的页面"}}},Ue=Ee,qe=Object(re["a"])(Ue,je,$e,!1,null,null,null),Re=qe.exports,Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("error-info",{attrs:{imgUrl:e.imgUrl,errText:e.errText}})},Be=[],Ye={components:{ErrorInfo:Oe},data:function(){return{imgUrl:a("7125"),errText:"抱歉，您没有权限查看"}}},Ge=Ye,Qe=Object(re["a"])(Ge,Me,Be,!1,null,null,null),Ve=Qe.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix",staticStyle:{padding:"15px 20px 0"}},[a("h3",{staticStyle:{width:"120px"}},[e._v("培训资料")]),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"资料形式",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.typeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属模块",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.module,callback:function(t){e.module=t},expression:"module"}},e._l(e.moduleList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属校区",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.campus,callback:function(t){e.campus=t},expression:"campus"}},e._l(e.campusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"用户类型",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1),a("el-input",{staticClass:"input-box",staticStyle:{width:"160px"},attrs:{placeholder:"请输入资料名称",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.$router.push("/train/add")}}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.setBatch}},[e._v("批量设置")])],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"},on:{"selection-change":e.selectRows}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"资料名称","show-overflow-tooltip":"",width:"100",fixed:""}}),a("el-table-column",{attrs:{prop:"type",label:"资料形式","show-overflow-tooltip":"",width:"100",formatter:function(t,a,s,i){return e.common.learnTypeFormat(s)}}}),a("el-table-column",{attrs:{prop:"modelNames",label:"所属模块","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"campusNames",label:"所属校区","show-overflow-tooltip":"",width:"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"usertypeNames",label:"用户类型","show-overflow-tooltip":"",width:"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"isDownload",label:"下载开启",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("1"==t.row.isDownload?"是":"否"))]}}])}),a("el-table-column",{attrs:{prop:"fileSize",label:"资料大小","show-overflow-tooltip":"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.formatStatus?a("span",{staticClass:"status-tag pending"},[e._v("转码中")]):e._e(),"3"==t.row.formatStatus?a("span",{staticClass:"status-tag error"},[e._v("转码失败")]):e._e(),"2"==t.row.formatStatus?a("span",{staticStyle:{color:"#606266"}},[e._v(e._s(e.common.learnSizeFormat(t.row.fileSize)))]):a("span",{staticStyle:{color:"#606266"}},[e._v("--")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":"",width:"160",formatter:e.common.timeFormat}}),a("el-table-column",{attrs:{prop:"watchCount",label:"浏览量",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{label:"排序",align:"center",width:"124",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.id?a("div",[1==e.currentPage&&0==t.$index?a("span",{staticClass:"disabled"},[a("i",{staticClass:"el-icon-top"}),e._v("上移 ")]):a("span",{on:{click:function(a){return e.move("up",t.row)}}},[a("i",{staticClass:"el-icon-top"}),e._v("上移 ")]),(e.currentPage-1)*e.pageSize+t.$index==e.total-1?a("span",{staticClass:"disabled"},[a("i",{staticClass:"el-icon-bottom"}),e._v("下移 ")]):a("span",{on:{click:function(a){return e.move("down",t.row)}}},[a("i",{staticClass:"el-icon-bottom"}),e._v("下移 ")])]):e._e()]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{directives:[{name:"show",rawName:"v-show",value:"2"==t.row.formatStatus||"3"==t.row.type,expression:"scope.row.formatStatus == '2' || scope.row.type == '3'"}],on:{click:function(a){return e.toDetail(t.row)}}},[e._v("查看")]),a("span",{on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1),a("set-drawer",{ref:"setDrawer",on:{doFunc:function(t){return e.getTableData(e.currentPage,e.pageSize)}}})],1)},He=[],Ke=a("5530");a("d81d"),a("b0c0"),a("4de4");function Xe(e){return P.postAjax({code:"url",url:"learn/pageQuery",isRep:!0,data:e})}function We(e){return P.postAjax({code:"url",url:"learn/delete/".concat(e),isGet:!0})}function Ze(e){return P.postAjax({code:"url",url:"learn/up",data:e})}function et(e){return P.postAjax({code:"url",url:"learn/down",data:e})}function tt(e){return P.postAjax({code:"url",url:"learn/save",isRep:!0,data:e})}function at(e){return P.postAjax({code:"url",url:"learn/batchSet",isRep:!0,data:e})}function st(e){return P.postAjax({code:"url",url:"learn/find/".concat(e),isGet:!0})}var it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"base-drawer",attrs:{title:"批量设置",visible:e.drawer,direction:"rtl",wrapperClosable:!1,size:"660px"},on:{"update:visible":function(t){e.drawer=t},close:e.closeDrawer}},[a("div",{staticClass:"drawer-container"},[a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,"label-position":"right","label-width":"100px","label-suffix":"：",size:"small"}},[a("el-form-item",{attrs:{label:"所属模块",prop:"modelIds"}},[a("el-checkbox-group",{model:{value:e.editForm.modelIds,callback:function(t){e.$set(e.editForm,"modelIds",t)},expression:"editForm.modelIds"}},e._l(e.moduleList,(function(t){return a("el-checkbox",{key:t.id,staticClass:"width-100",attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"所属校区",prop:"campusIds"}},[a("el-checkbox-group",{model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,staticClass:"width-100",attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"用户类型",prop:"usertypeCodes"}},[a("el-checkbox-group",{model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,staticClass:"width-100",attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1)],1)],1)]),a("div",{staticClass:"drawer-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawer=!1}}},[e._v("取消")])],1)])},ot=[],nt={data:function(){return{drawer:!1,drawerLoading:!1,editForm:{learnIds:[],modelIds:[],campusIds:[],usertypeCodes:[]}}},computed:Object(O["b"])({moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList}}),methods:{closeDrawer:function(){this.$refs.editForm.resetFields(),this.editForm={learnIds:[],modelIds:[],campusIds:[],usertypeCodes:[]}},save:function(){var e=this;this.drawerLoading=!0;var t=Object(Ke["a"])({},this.editForm);at(t).then((function(t){e.drawerLoading=!1,"000000"==t.code?(e.$message({showClose:!0,type:"success",message:"保存成功!"}),e.drawer=!1,e.$emit("doFunc")):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.drawerLoading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}},created:function(){0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},rt=nt,lt=Object(re["a"])(rt,it,ot,!1,null,null,null),ct=lt.exports,ut={components:{SetDrawer:ct},data:function(){return{type:[],module:[],campus:[],userType:[],keyword:null,tableData:[],loading:!1,selectArr:[],total:0,currentPage:1,pageSize:20,sort:null,orderBy:null}},computed:Object(O["b"])({typeList:function(e){return e.trainTypeList},moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList}}),methods:{toDetail:function(e){this.$router.push("/train/view/".concat(e.type,"/").concat(e.id))},selectRows:function(e){this.selectArr=e},setBatch:function(){if(0!=this.selectArr.length){var e=this.$refs.setDrawer;e.editForm.learnIds=this.selectArr.map((function(e){return e.id})),e.drawer=!0}else this.$message({showClose:!0,type:"error",message:"请选择需要设置的培训资料！"})},deleteRow:function(e){var t=this;this.$confirm("是否确认删除培训资料『 ".concat(e.name," 』？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,We(e.id).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"删除成功！"}),t.getTableData(0,t.pageSize)):t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e)})}))})).catch((function(){}))},move:function(e,t){var a=this,s="up"==e?Ze:et,i="up"==e?"培训资料上移":"培训资料下移";this.loading=!0,s({id:t.id}).then((function(e){a.loading=!1,"000000"==e.code?a.getTableData(a.currentPage,a.pageSize):a.$message({showClose:!0,type:"error",message:"".concat(i,"失败：").concat(e.msg)})})).catch((function(e){a.loading=!1,a.$message({showClose:!0,type:"error",message:"".concat(i,"失败：").concat(e)})}))},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{types:this.type.join(",")||null,modelIds:this.module.join(",")||null,campusIds:this.campus.join(",")||null,usertypeCodes:this.userType.join(",")||null,name:this.keyword||null},limit:t,page:e||1};Xe(s).then((function(i){if(a.loading=!1,"000000"==i.code){a.tableData=i.data||[],a.total=i.total,a.currentPage=e||1,a.tableData.sort((function(e,t){return e.level>t.level?1:-1}));var o=Object(Ke["a"])(Object(Ke["a"])({},s.filter),{},{limit:t,page:e||1});sessionStorage.setItem("trainParams",JSON.stringify(o))}})).catch((function(e){a.loading=!1}))},initParams:function(){var e=sessionStorage.getItem("trainParams");if(e){var t=JSON.parse(e),a=t.types,s=t.moduleIds,i=t.campusIds,o=t.usertypeCodes,n=t.name,r=t.limit,l=t.page;this.type=a?a.split(","):[],this.module=s?s.split(","):[],this.campus=i?i.split(","):[],this.userType=o?o.split(","):[],this.keyword=n,this.pageSize=r,this.currentPage=l}}},created:function(){this.initParams(),this.getTableData(this.currentPage,this.pageSize),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},dt=ut,pt=(a("6419"),Object(re["a"])(dt,Je,He,!1,null,"7075f9f2",null)),mt=pt.exports,ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.editForm.id?"编辑资料":"新增资料")+" "),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")])],1)],1),a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,rules:e.rules,"label-position":"right","label-width":"100px","label-suffix":"：",size:"small"}},[a("el-form-item",{attrs:{label:"资料形式",prop:"type"}},[a("el-radio-group",{on:{change:e.resetFile},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.typeList,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"1"==e.editForm.type,expression:"editForm.type == '1'"}],attrs:{label:"上传视频",prop:"file",rules:[{required:"1"==e.editForm.type,trigger:"change",message:"请上传文件"}]}},[a("div",{staticClass:"upload-box"},[a("p",{staticClass:"img-des"},[e._v("支持格式 mpeg、mpg、dat、mp4、mkv")]),a("video-file-upload",{key:"video",ref:"videoUpload",attrs:{type:"video",url:e.videoUploadUrl},on:{transLoading:e.load,done:e.videoUploaded}})],1)]),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"2"==e.editForm.type,expression:"editForm.type == '2'"}],attrs:{label:"上传文件",prop:"file",rules:[{required:"2"==e.editForm.type,trigger:"change",message:"请上传文件"}]}},[a("div",{staticClass:"upload-box"},[a("p",{staticClass:"img-des"},[e._v("支持格式 pdf、doc、docx、xls、xlsx、ppt、pptx")]),a("video-file-upload",{key:"file",ref:"fileUpload",attrs:{type:"file",url:e.fileUploadUrl},on:{transLoading:e.load,done:e.fileUploaded}})],1)]),a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{label:"资料封面",prop:"cover"}},[a("div",{staticClass:"upload-box"},[a("p",{staticClass:"img-des"},[e._v("支持格式 png、jpg、gif")]),a("img-upload",{ref:"imgUpload",attrs:{url:e.imgUploadUrl,onlyOne:!0,multiple:!1},on:{done:e.imgUploaded}})],1)]),a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{label:"资料名称",prop:"name"}},[a("el-input",{staticStyle:{width:"538px"},attrs:{size:"small",placeholder:"请输入"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"资料简介",prop:"desc"}},[a("el-input",{staticStyle:{width:"538px"},attrs:{type:"textarea",maxlength:"250",rows:"8",resize:"none",placeholder:"请输入资料简介，不超过250字"},model:{value:e.editForm.desc,callback:function(t){e.$set(e.editForm,"desc",t)},expression:"editForm.desc"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"3"==e.editForm.type,expression:"editForm.type == '3'"}],attrs:{label:"资料内容",prop:"dhtml","show-message":!1,rules:[{required:"3"==e.editForm.type,trigger:"change",message:"请输入资料内容"}]}}),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"3"==e.editForm.type,expression:"editForm.type == '3'"}],staticStyle:{"margin-left":"-100px"},attrs:{prop:"dhtml"}},[a("wang-editor",{ref:"editor",staticClass:"editor",on:{change:e.changeHtml}})],1),a("el-divider"),a("h3",[e._v("其他设置")]),a("el-form-item",{attrs:{label:"所属模块",prop:"modelIds"}},[a("el-checkbox-group",{model:{value:e.editForm.modelIds,callback:function(t){e.$set(e.editForm,"modelIds",t)},expression:"editForm.modelIds"}},e._l(e.moduleList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"所属校区",prop:"campusIds"}},[a("el-checkbox-group",{model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"用户类型",prop:"usertypeCodes"}},[a("el-checkbox-group",{model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1),"3"!=e.editForm.type?a("el-form-item",{attrs:{label:"开启下载",prop:"isDownload"}},[a("div",{staticClass:"switch"},[a("el-switch",{ref:"switch",attrs:{width:42,"active-value":1,"inactive-value":0},model:{value:e.editForm.isDownload,callback:function(t){e.$set(e.editForm,"isDownload",t)},expression:"editForm.isDownload"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.editForm.isDownload,expression:"editForm.isDownload==1"}],staticClass:"on",on:{click:function(t){e.editForm.isDownload=0}}},[e._v("开")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.editForm.isDownload,expression:"editForm.isDownload==0"}],staticClass:"off",on:{click:function(t){e.editForm.isDownload=1}}},[e._v("关")])],1)]):e._e()],1)],1)])},ht=[],gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{icon:"el-icon-upload2",size:"small",loading:e.loading},on:{click:e.clickInput}},[e._v("上传文件")]),a("span",{staticClass:"file"},[e._v(e._s(e.file.name))]),e.loading?a("span",{staticClass:"percent"},[e._v(e._s(e.percent)+"%")]):e._e(),"1"==e.result?a("i",{staticClass:"el-icon-success"}):e._e(),"0"==e.result?a("i",{staticClass:"el-icon-error"}):e._e(),a("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:e.accept},on:{change:e.select}})],1)},bt=[],vt=(a("b680"),{props:{size:Number,url:String,type:String},data:function(){return{loading:!1,file:{},percent:0,result:null,accept:"video"==this.type?"video/*":".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx"}},methods:{reset:function(){this.loading=!1,this.file={},this.percent=0,this.result=null},getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},clickInput:function(){this.$refs.fileInput.click()},select:function(e){var t=this,a=e.target.files[0];if("video"==this.type&&-1==["video/mpeg","video/mpg","video/dat","video/mp4","video/mkv"].indexOf(a.type))return this.$message({showClose:!0,type:"error",message:"请上传正确的视频格式文件！"}),!1;if("file"==this.type){var s=a.name.split("."),i=s[s.length-1].toLowerCase();if(-1==["pdf","doc","docx","xls","xlsx","ppt","pptx"].indexOf(i))return this.$message({showClose:!0,type:"error",message:"请上传正确的格式文件！"}),!1}if(this.size){var o=1024*this.size*1024;if(a.size>o)return this.$message({showClose:!0,type:"error",message:"大小不能超过".concat(this.size,"MB！")}),!1}this.file=a,this.loading=!0,this.$emit("transLoading",this.loading);var n=new FormData;n.append("file",a);var r={url:this.url,method:"POST",headers:{IDSTGC:this.getCookie("IDSTGC")},data:n,onUploadProgress:function(e){e.lengthComputable&&(t.percent=(e.loaded/e.total*100).toFixed(0))}};w()(r).then((function(e){var a=e.data;"000000"==a.code?(t.result="1",t.$message({showClose:!0,type:"success",message:"上传成功！"}),t.$emit("done",a)):(t.result="0",t.$message({showClose:!0,type:"error",message:"上传失败："+a.msg})),t.$refs.fileInput.value=null,t.loading=!1,t.$emit("transLoading",t.loading)})).catch((function(e){t.result="0",t.loading=!1,t.$emit("transLoading",t.loading),t.$message({showClose:!0,type:"error",message:"上传失败："+e})}))}}}),wt=vt,yt=(a("7a0d"),Object(re["a"])(wt,gt,bt,!1,null,"9fd4da4a",null)),xt=yt.exports,Ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{icon:"el-icon-upload2",size:"small",loading:e.loading},on:{click:e.clickInput}},[e._v("上传图片")]),e._l(e.photos,(function(t,s){return a("div",{key:t.ID,staticClass:"upload-imgs"},[a("img",{attrs:{src:e.fileUrl+t.ID,alt:""}}),a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.deletePhoto(s)}}})])})),a("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",multiple:e.multiple},on:{change:e.select}})],2)},kt=[],St=a("1da1");a("96cf"),a("a434"),a("a630"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("c19f");function _t(e,t){var a=this,s=.52;return parseInt((e.size/1024).toFixed(2))<1024&&(s=.85),5120<parseInt((e.size/1024).toFixed(2))&&(s=.92),t&&(s=t),e[0]?Promise.all(Array.from(e).map((function(e){return a.compressImage(e,s)}))):new Promise((function(t){if((e.size/1024).toFixed(2)<300)t({file:e});else{var a=new FileReader;a.onload=function(a){var i=a.target.result,o=new Image;o.onload=Object(St["a"])(regeneratorRuntime.mark((function a(){var n,r,l,c,u,d,p,m,f,h,g,b,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=document.createElement("canvas"),r=n.getContext("2d"),l=o.width,c=o.height,u=o.width,d=o.height,1024<=parseInt((e.size/1024).toFixed(2))&&parseInt((e.size/1024).toFixed(2))<=10240&&(p=1600,m=1600,l=u,c=d,(u>p||d>m)&&(u/d>p/m?(l=p,c=Math.round(p*(d/u))):(c=m,l=Math.round(m*(u/d))))),10240<=parseInt((e.size/1024).toFixed(2))&&parseInt((e.size/1024).toFixed(2))<=20480&&(p=1400,m=1400,l=u,c=d,(u>p||d>m)&&(u/d>p/m?(l=p,c=Math.round(p*(d/u))):(c=m,l=Math.round(m*(u/d))))),n.width=l,n.height=c,r.clearRect(0,0,l,c),r.drawImage(o,0,0,l,c),f=n.toDataURL("image/jpeg",s),h=atob(f.split(",")[1]),g=h.length,b=new Uint8Array(new ArrayBuffer(g));while(g--)b[g]=h.charCodeAt(g);v=new File([b],e.name,{type:"image/jpeg"}),console.log({file:v,origin:e,beforeSrc:i,afterSrc:f,beforeKB:Number((e.size/1024).toFixed(2)),afterKB:Number((v.size/1024).toFixed(2)),qualitys:s}),t({file:v,origin:e,beforeSrc:i,afterSrc:f,beforeKB:Number((e.size/1024).toFixed(2)),afterKB:Number((v.size/1024).toFixed(2))});case 20:case"end":return a.stop()}}),a)}))),o.src=i},a.readAsDataURL(e)}}))}var Ft={props:{multiple:Boolean,size:Number,conversion:Boolean,onlyOne:Boolean,url:String},data:function(){return{loading:!1,fileUrl:window.g.viewUrl,fileList:[],conversionFileList:[],photos:[]}},methods:{reset:function(){this.loading=!1,this.fileList=[],this.conversionFileList=[],this.photos=[]},getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},conversionFile:function(e){return new Promise((function(t,a){_t(e).then((function(a){var s=a.file,i=new File([s],e.name,{type:s.type,lastModified:Date.now()});t(i)}))}))},clickInput:function(){this.$refs.fileInput.click()},select:function(e){var t=this;return Object(St["a"])(regeneratorRuntime.mark((function a(){var s,i,o,n,r,l,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.fileList=e.target.files||[],0!=t.fileList.length){a.next=3;break}return a.abrupt("return");case 3:s=0;case 4:if(!(s<t.fileList.length)){a.next=22;break}if(i=t.fileList[s],-1!=["image/png","image/jpg","image/jpeg","image/gif"].indexOf(i.type)){a.next=9;break}return t.$message({showClose:!0,type:"error",message:"请上传正确格式的图片！"}),a.abrupt("return",!1);case 9:if(!t.size){a.next=14;break}if(o=1024*t.size*1024,!(i.size>o)){a.next=14;break}return t.$message({showClose:!0,type:"error",message:"图片大小不能超过".concat(t.size,"MB！")}),a.abrupt("return",!1);case 14:if(!t.conversion){a.next=19;break}return a.next=17,t.conversionFile(item);case 17:n=a.sent,t.conversionFileList.push(n);case 19:s++,a.next=4;break;case 22:for(r=t.conversion?t.conversionFileList:t.fileList,t.loading=!0,l=new FormData,c=0;c<r.length;c++)l.append("file",r[c]);u={url:t.url,method:"POST",headers:{IDSTGC:t.getCookie("IDSTGC")},data:l},w()(u).then((function(e){t.loading=!1;var a=e.data;0==a.login?(t.$message({showClose:!0,type:"error",message:"用户未登录，即将跳转登录页面！"}),setTimeout((function(){var e=window.document.location.pathname,t=e.substring(0,e.substr(1).indexOf("/")+1),a=t+"/",s=document.location.href;location.href=a+"rest/Idsclient/reqLogin?reqUrl="+encodeURIComponent(s)}),3e3)):a.success?(t.$message({showClose:!0,type:"success",message:"上传成功！"}),t.onlyOne?t.photos=a.data:t.photos=t.photos.concat(a.data),t.$emit("done",t.photos)):t.$message({showClose:!0,type:"error",message:"上传失败："+a.data.msg}),t.$refs.fileInput.value=null})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"上传失败："+e})}));case 28:case"end":return a.stop()}}),a)})))()},deletePhoto:function(e){this.photos.splice(e,1),this.$emit("done",this.photos)}}},Lt=Ft,Dt=(a("122e"),Object(re["a"])(Lt,Ct,kt,!1,null,"a93cc112",null)),Tt=Dt.exports,jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"unique",attrs:{id:"editor"}})},$t=[],It=a("6fad"),zt=a.n(It),Nt={data:function(){return{editor:null}},mounted:function(){var e=this;this.editor=new zt.a("#editor"),this.editor.config.menus=["head","bold","fontSize","italic","underline","strikeThrough","indent","lineHeight","link","justify","image","table","splitLine","quote","emoticon","undo","redo"],this.editor.config.uploadImgShowBase64=!0,this.editor.config.showLinkImg=!1,this.editor.config.onchangeTimeout=500,this.editor.config.onchange=function(t){e.$emit("change",t)},this.editor.create()},beforeDestroy:function(){this.editor=null}},At=Nt,Pt=(a("9d51"),Object(re["a"])(At,jt,$t,!1,null,null,null)),Ot=Pt.exports,Et={components:{VideoFileUpload:xt,ImgUpload:Tt,WangEditor:Ot},props:{id:String},data:function(){return{loading:!1,videoUploadUrl:window.g.videoUploadUrl,fileUploadUrl:window.g.fileUploadUrl,imgUploadUrl:window.g.uploadUrl,editForm:{id:this.id||null,name:null,cover:null,type:"1",file:null,desc:null,dhtml:null,modelIds:[],campusIds:[],usertypeCodes:[],isDownload:1},rules:{type:[{required:!0,trigger:"change",message:"请选择资料形式"}],name:[{required:!0,trigger:"change",message:"请输入资料名称"}]},detail:{}}},computed:Object(O["b"])({typeList:function(e){return e.trainTypeList},moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList}}),methods:{load:function(e){this.loading=e},resetFile:function(){this.$refs.videoUpload.reset(),this.$refs.fileUpload.reset(),this.editForm.file=null,this.editForm.dhtml=null},videoUploaded:function(e){this.editForm.file=e.data,this.$refs.editForm.validateField("file")},fileUploaded:function(e){this.editForm.file=e.data,this.$refs.editForm.validateField("file")},imgUploaded:function(e){e&&e[0]?this.editForm.cover=e[0].ID:this.editForm.cover=null},changeHtml:function(e){this.editForm.dhtml=e},save:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){e.loading=!0;var a=Object(Ke["a"])(Object(Ke["a"])({},e.editForm),e.editForm.file);delete a.file,tt(a).then((function(t){e.loading=!1,"000000"==t.code?(e.$message({showClose:!0,type:"success",message:"保存成功："}),setTimeout((function(){e.$router.go(-1)}),500)):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))},chooseAllCampus:function(){this.editForm.campusIds=this.campusList.map((function(e){return e.id}))},chooseAllUsertype:function(){this.editForm.usertypeCodes=this.userTypeList.map((function(e){return e.code}))},getDetail:function(){var e=this;this.loading=!0,st(this.id).then((function(t){if(e.loading=!1,"000000"==t.code){var a=t.data||{};e.initDetail(a)}else e.$message({showClose:!0,type:"error",message:"获取详情失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取详情失败："+t})}))},initDetail:function(e){for(var t in this.editForm)this.editForm[t]=e[t]||null;this.editForm.file={fileName:e.fileName,fileSize:e.fileSize,fileUrl:e.fileUrl,formatStatus:e.formatStatus},this.editForm.modelIds=e.models?e.models.map((function(e){return e.id})):[],this.editForm.campusIds=e.campuss?e.campuss.map((function(e){return e.id})):[],this.editForm.usertypeCodes=e.usertypes?e.usertypes.map((function(e){return e.code})):[],e.cover&&(this.$refs.imgUpload.photos=[{ID:e.cover}]),"1"==e.type&&(this.$refs.videoUpload.file={name:e.fileName}),(e.type="2")&&(this.$refs.fileUpload.file={name:e.fileName}),(e.type="3")&&this.$refs.editor.editor.txt.html(e.dhtml)}},created:function(){this.editForm.id?this.getDetail():(this.chooseAllCampus(),this.chooseAllUsertype()),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},Ut=Et,qt=(a("c68f"),Object(re["a"])(Ut,ft,ht,!1,null,"22f61149",null)),Rt=qt.exports,Mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"base-search-table detail"},[s("div",{staticClass:"search-box clearfix"},[s("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),s("el-divider",{attrs:{direction:"vertical"}}),e._v("查看资料 "),s("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.toEdit}},[e._v("编辑")]),s("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.deleteTrain}},[e._v("删除")])],1)],1),s("div",{staticClass:"content"},[s("h3",[e._v(e._s(e.detail.name))]),s("div",{staticClass:"sub"},[s("p",{staticClass:"w"},[e._v(" "+e._s(e.detail.watchCount)+"阅读 · "+e._s("3"!=e.type?e.detail.downloadCount+"下载 ·":"")+" "+e._s("3"!=e.type?e.common.learnSizeFormat(e.detail.fileSize)+" ·":"")+" "+e._s(e.common.defaultTimeFormat(e.detail.createTime))+" ")]),"3"!=e.type?s("p",{staticClass:"download",on:{click:e.downloadF}},[s("img",{attrs:{src:a("c9b9")}}),e._v("下载")]):e._e()]),e.detail.id?s("div",{staticClass:"video-box"},["1"==e.type?s("video",{ref:"video",attrs:{controls:"",src:e.fileViewUrl+e.detail.id}},[e._v(" 您的浏览器不支持HTML5 video标签 ")]):e._e(),"2"==e.type?s("iframe",{ref:"pdf",attrs:{src:e.fileViewUrl+e.detail.id,width:"100%",height:"680px"}}):e._e()]):e._e(),s("div",{staticClass:"desc-box"},[s("img",{attrs:{src:e.imgViewUrl+e.detail.cover,alt:""}}),s("div",{staticClass:"desc"},[e._v(e._s(e.detail.desc))])]),"3"==e.type?s("div",{staticClass:"dhtml",domProps:{innerHTML:e._s(e.detail.dhtml)}}):e._e(),s("div",{staticClass:"tag-box"},[s("div",[s("label",[e._v("所属模块：")]),s("div",{staticClass:"tags"},e._l(e.detail.models,(function(t){return s("span",{key:t.id},[e._v(e._s(t.name))])})),0)]),s("div",[s("label",[e._v("所属校区：")]),s("div",{staticClass:"tags"},e._l(e.detail.campuss,(function(t){return s("span",{key:t.id},[e._v(e._s(t.name))])})),0)]),s("div",[s("label",[e._v("用户类型：")]),s("div",{staticClass:"tags"},e._l(e.detail.usertypes,(function(t){return s("span",{key:t.id},[e._v(e._s(t.name))])})),0)]),"3"!=e.type?s("div",[s("label",[e._v("开启下载：")]),s("span",[e._v(e._s("1"==e.detail.isDownload?"是":"否"))])]):e._e()])])])},Bt=[],Yt={props:{type:String,id:String},data:function(){return{loading:!1,detail:{},fileViewUrl:window.g.fileViewUrl,imgViewUrl:window.g.viewUrl}},methods:{downloadF:function(){var e=this.detail.fileName,t=e.split(".")||[],a=t.length,s=a&&t[a-1],i=e.indexOf("."+s),o=e.substring(0,i);this.util.exportFile("learn/download/"+this.id,!0,{},o,"pdf")},toEdit:function(){this.$router.push("/train/edit/".concat(this.id))},getDetail:function(){var e=this;this.loading=!0,st(this.id).then((function(t){e.loading=!1,"000000"==t.code?e.detail=t.data||{}:e.$message({showClose:!0,type:"error",message:"获取详情失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取详情失败："+t})}))},deleteTrain:function(){var e=this,t=this.$createElement;this.$confirm("","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",message:t("p",null,[t("span",{style:"white-space: normal"},"是否确认删除培训资料『 ".concat(this.detail.name,"』？"))])}).then((function(){e.loading=!0,We(e.id).then((function(t){e.loading=!1,"000000"==t.code?(e.$message({showClose:!0,type:"success",message:"删除成功！"}),e.$router.go(-1)):e.$message({showClose:!0,type:"error",message:"删除失败：".concat(t.msg)})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"删除失败：".concat(t)})}))})).catch((function(){}))}},created:function(){this.getDetail()}},Gt=Yt,Qt=(a("1fad"),Object(re["a"])(Gt,Mt,Bt,!1,null,"53e0810a",null)),Vt=Qt.exports,Jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box"},[a("el-select",{staticClass:"no-wrap",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"是否必考",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.isImportant,callback:function(t){e.isImportant=t},expression:"isImportant"}},e._l(e.isImportantList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属模块",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.module,callback:function(t){e.module=t},expression:"module"}},e._l(e.moduleList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属校区",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.campus,callback:function(t){e.campus=t},expression:"campus"}},e._l(e.campusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"用户类型",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1),a("el-input",{staticClass:"input-box",staticStyle:{width:"160px"},attrs:{placeholder:"请输入题目内容",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.downTemplate}},[e._v("模板下载")]),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.upload}},[e._v("题库上传")]),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.exportData}},[e._v("导出题库")])],1),a("div",{staticClass:"table-content"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.questionType,callback:function(t){e.questionType=t},expression:"questionType"}},e._l(e.questionTypeList,(function(e){return a("el-tab-pane",{key:e.value,attrs:{label:e.label,name:e.value}})})),1),a("div",{staticClass:"tab-box"},[a("span",[e._v("总计"+e._s(e.total)+"条")]),a("div",{staticClass:"right-btn"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addType}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.setBatch}},[e._v("批量设置")]),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.deleteBatch}},[e._v("批量删除")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"},on:{"selection-change":e.selectRows}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"subject",label:"题目内容","show-overflow-tooltip":"",width:"500",fixed:""}}),"3"==e.questionType?a("el-table-column",{attrs:{prop:"isTrue",label:"答案","show-overflow-tooltip":"",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("1"==t.row.isTrue?"对":"错"))]}}],null,!1,2454342917)}):e._e(),"1"==e.questionType||"2"==e.questionType?a("el-table-column",{attrs:{prop:"options",label:"选项","show-overflow-tooltip":"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.options,(function(t){return a("div",{key:t.id},["1"==e.questionType?a("input",{attrs:{type:"radio"},domProps:{checked:1==t.isReal}}):e._e(),"2"==e.questionType?a("input",{attrs:{type:"checkbox"},domProps:{checked:1==t.isReal}}):e._e(),a("span",{staticStyle:{color:"#5f6464"}},[e._v(e._s(t.itemInfo))])])}))}}],null,!1,1474917095)}):e._e(),a("el-table-column",{attrs:{prop:"modelNames",label:"所属模块","show-overflow-tooltip":"","min-width":"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"campusNames",label:"所属校区","show-overflow-tooltip":"","min-width":"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"usertypeNames",label:"用户类型","show-overflow-tooltip":"","min-width":"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"isImportant",label:"是否必考",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("1"==t.row.isImportant?"是":"否"))]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.toEdit(t.row)}}},[e._v("编辑")]),a("span",{on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1),a("set-drawer",{ref:"setDrawer",on:{doFunc:function(t){return e.getTableData(e.currentPage,e.pageSize)}}}),a("upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{multiple:!1,size:5120,exts:"xls|XLS|xlsx|XLSX",url:e.uploadUrl},on:{done:e.uploaded,choose:function(t){e.loading=!0}}})],1)},Ht=[];function Kt(e){return P.postAjax({code:"url",url:"question/pageQuery",isRep:!0,data:e})}function Xt(e){return P.postAjax({code:"url",url:"question/delete/".concat(e),isGet:!0})}function Wt(e){return P.postAjax({code:"url",url:"question/save",isRep:!0,data:e})}function Zt(e){return P.postAjax({code:"url",url:"question/batchSet",isRep:!0,data:e})}function ea(e){return P.postAjax({code:"url",url:"question/batchDelete",isRep:!0,data:e})}function ta(e){return P.postAjax({code:"url",url:"question/questionPool",isRep:!0,data:e})}function aa(e){return P.postAjax({code:"url",url:"question/find/".concat(e),isGet:!0})}var sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"base-drawer",attrs:{title:"批量设置",visible:e.drawer,direction:"rtl",wrapperClosable:!1,size:"660px"},on:{"update:visible":function(t){e.drawer=t},close:e.closeDrawer}},[a("div",{staticClass:"drawer-container"},[a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,"label-position":"right","label-width":"100px","label-suffix":"：",size:"small"}},[a("el-form-item",{attrs:{label:"所属模块",prop:"modelIds"}},[a("el-checkbox-group",{model:{value:e.editForm.modelIds,callback:function(t){e.$set(e.editForm,"modelIds",t)},expression:"editForm.modelIds"}},e._l(e.moduleList,(function(t){return a("el-checkbox",{key:t.id,staticClass:"width-100",attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"所属校区",prop:"campusIds"}},[a("el-checkbox-group",{model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,staticClass:"width-100",attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"用户类型",prop:"usertypeCodes"}},[a("el-checkbox-group",{model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,staticClass:"width-100",attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"是否必考",prop:"isImportant"}},[a("div",{staticClass:"switch"},[a("el-switch",{ref:"switch",attrs:{width:42,"active-value":1,"inactive-value":0},model:{value:e.editForm.isImportant,callback:function(t){e.$set(e.editForm,"isImportant",t)},expression:"editForm.isImportant"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.editForm.isImportant,expression:"editForm.isImportant==1"}],staticClass:"on",on:{click:function(t){e.editForm.isImportant=0}}},[e._v("是")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.editForm.isImportant,expression:"editForm.isImportant==0"}],staticClass:"off",on:{click:function(t){e.editForm.isImportant=1}}},[e._v("否")])],1)])],1)],1)]),a("div",{staticClass:"drawer-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawer=!1}}},[e._v("取消")])],1)])},ia=[],oa={data:function(){return{drawer:!1,drawerLoading:!1,editForm:{questionIds:[],modelIds:[],campusIds:[],usertypeCodes:[],isImportant:1}}},computed:Object(O["b"])({moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList}}),methods:{closeDrawer:function(){this.$refs.editForm.resetFields(),this.editForm={questionIds:[],modelIds:[],campusIds:[],usertypeCodes:[],isImportant:1}},save:function(){var e=this;this.drawerLoading=!0;var t=Object(Ke["a"])({},this.editForm);Zt(t).then((function(t){e.drawerLoading=!1,"000000"==t.code?(e.$message({showClose:!0,type:"success",message:"保存成功!"}),e.drawer=!1,e.$emit("doFunc")):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.drawerLoading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}},created:function(){0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},na=oa,ra=(a("70c2"),Object(re["a"])(na,sa,ia,!1,null,"491e85fa",null)),la=ra.exports,ca=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("span",{staticClass:"uploadbtn",on:{click:e.toupload}},[e._v("上传文件")]),a("input",{ref:"uploaddom",staticClass:"uploadinput",attrs:{type:"file",rel:"files",multiple:e.multiple,title:"上传文件"},on:{change:e.getFile}})])},ua=[],da={name:"upload",data:function(){return{fileList:[],conversionFileList:[]}},methods:{getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},conversionFile:function(e){return new Promise((function(t,a){_t(e).then((function(a){var s=a.file,i=new File([s],e.name,{type:s.type,lastModified:Date.now()});t(i)}))}))},getFile:function(e){var t=this;return Object(St["a"])(regeneratorRuntime.mark((function a(){var s,i,o,n,r,l,c,u,d,p,m,f;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.conversionFileList=[],t.fileList=e.target.files,t.fileList&&0!==t.fileList.length){a.next=4;break}return a.abrupt("return",!1);case 4:s=t.exts.split("|"),i=0;case 6:if(!(i<t.fileList.length)){a.next=28;break}if(o=t.fileList[i],n=o.name.split("."),r=n[n.length-1].toLowerCase(),-1!==s.indexOf(r.toLowerCase())){a.next=14;break}throw t.$alert("上传文件的格式必须为：\n"+t.exts,"提示",{type:"error",callback:function(e){}}),t.$refs.uploaddom.value=null,"上传了不符合后缀的文件！";case 14:if(!t.size){a.next=20;break}if(l=1024*t.size,!(o.size>l)){a.next=20;break}throw t.$alert("上传文件超过限制大小！","提示",{type:"error",callback:function(e){}}),t.$refs.uploaddom.value=null,"上传文件超过限制大小！";case 20:if(!t.conversion){a.next=25;break}return a.next=23,t.conversionFile(o);case 23:c=a.sent,t.conversionFileList.push(c);case 25:i++,a.next=6;break;case 28:for(u=t.conversion?t.conversionFileList:t.fileList,t.$emit("choose",u),d=new FormData,p=0;p<u.length;p++)d.append("file",u[p]);if(t.extraParams)for(m in t.extraParams)d.append(m,t.extraParams[m]);f={url:t.url,method:"POST",headers:{IDSTGC:t.getCookie("IDSTGC")},data:d},w()(f).then((function(e){var a=e.data;0==a.login?(t.$message({showClose:!0,type:"error",message:"用户未登录，即将跳转登录页面！"}),setTimeout((function(){var e=window.document.location.pathname,t=e.substring(0,e.substr(1).indexOf("/")+1),a=t+"/",s=document.location.href;location.href=a+"rest/Idsclient/reqLogin?reqUrl="+encodeURIComponent(s)}),3e3)):t.$emit("done",a),t.$refs.uploaddom.value=null})).catch((function(e){t.$message({showClose:!0,type:"error",message:"上传失败："+e})}));case 35:case"end":return a.stop()}}),a)})))()},toupload:function(){this.$refs.uploaddom.click()}},watch:{},props:{url:String,exts:String,size:[String,Number],multiple:!1!==Boolean,choose:Function,beforeupload:Function,done:Function,autoupload:!1!==Boolean,extraParams:Object,conversion:{type:!1,default:!1},conversionSize:{type:Number,default:400}},created:function(){this.exts=this.exts?this.exts:"jpg|png|jpeg|bmp|gif|txt|doc|xlsx|xls|ppt|rar|zip"}},pa=da,ma=(a("1f7d"),Object(re["a"])(pa,ca,ua,!1,null,"b88b5a50",null)),fa=ma.exports,ha={components:{SetDrawer:la,Upload:fa},data:function(){return{isImportant:null,isImportantList:[{id:1,name:"是"},{id:0,name:"否"}],module:[],campus:[],userType:[],keyword:null,questionType:"3",tableData:[],loading:!1,selectArr:[],total:0,currentPage:1,pageSize:20,sort:null,orderBy:null,uploadUrl:window.g.url+"question/importQuestions"}},computed:Object(O["b"])({moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList},questionTypeList:function(e){return e.questionTypeList}}),methods:{addType:function(){this.$router.push({path:"/question/add"}),this.$store.commit("setQType",this.questionType)},downTemplate:function(){var e="".concat(window.g.url,"question/downloadTemplate");window.open(e,"_blank")},upload:function(){this.$refs.upload.toupload()},uploaded:function(e){if(this.loading=!1,"000000"==e.code){var t=e.data||{},a=t.importFlag||!0;if(a)this.$message({showClose:!0,message:"导入成功！",type:"success"}),this.getTableData(1,this.pageSize),this.getGradeList();else{var s="",i=t.errors||{};for(var o in i)s+="第".concat(o,"行：").concat(i[o])+"\n";this.$message({showClose:!0,message:"导入失败：\n"+s,type:"error"})}}else this.$message({showClose:!0,message:"导入失败："+e.msg,type:"error"})},exportData:function(){var e={};this.util.exportFile("question/exportQuestions",!1,e,"导出题库","xlsx")},handleClick:function(e){this.getTableData(this.currentPage,this.pageSize)},toEdit:function(e){this.$router.push("/question/edit/".concat(e.id))},selectRows:function(e){this.selectArr=e},setBatch:function(){if(0!=this.selectArr.length){var e=this.$refs.setDrawer;e.editForm.questionIds=this.selectArr.map((function(e){return e.id})),e.drawer=!0}else this.$message({showClose:!0,type:"error",message:"请选择需要设置的题目！"})},deleteBatch:function(){var e=this;0!=this.selectArr.length?this.$confirm("是否确认删除所选择的题目？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,ea(e.selectArr.map((function(e){return e.id}))).then((function(t){e.loading=!1,"000000"==t.code?(e.$message({showClose:!0,type:"success",message:"删除成功！"}),e.getTableData(0,e.pageSize)):e.$message({showClose:!0,type:"error",message:"删除失败：".concat(t.msg)})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"删除失败：".concat(t)})}))})).catch((function(){})):this.$message({showClose:!0,type:"error",message:"请选择需要删除的题目！"})},deleteRow:function(e){var t=this;this.$confirm("是否确认删除该题目？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Xt(e.id).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"删除成功！"}),t.getTableData(0,t.pageSize)):t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e)})}))})).catch((function(){}))},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{type:this.questionType||null,isImportant:[0,1].includes(this.isImportant)?this.isImportant:null,modelIds:this.module.join(",")||null,campusIds:this.campus.join(",")||null,usertypeCodes:this.userType.join(",")||null,subject:this.keyword||null},limit:t,page:e||1};Kt(s).then((function(i){if(a.loading=!1,"000000"==i.code){a.tableData=i.data||[],a.total=i.total,a.currentPage=e||1;var o=Object(Ke["a"])(Object(Ke["a"])({},s.filter),{},{limit:t,page:e||1});sessionStorage.setItem("questionParams",JSON.stringify(o))}})).catch((function(e){a.loading=!1}))},initParams:function(){var e=sessionStorage.getItem("questionParams");if(e){var t=JSON.parse(e),a=t.type,s=t.isImportant,i=t.moduleIds,o=t.campusIds,n=t.usertypeCodes,r=t.subject,l=t.limit,c=t.page;this.questionType=a,this.isImportant=s,this.module=i?i.split(","):[],this.campus=o?o.split(","):[],this.userType=n?n.split(","):[],this.keyword=r,this.pageSize=l,this.currentPage=c}}},created:function(){this.initParams(),this.getTableData(this.currentPage,this.pageSize),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},ga=ha,ba=(a("34f9"),Object(re["a"])(ga,Jt,Ht,!1,null,"f1394926",null)),va=ba.exports,wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.editForm.id?"编辑题目":"新增题目")+" "),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")])],1)],1),a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,rules:e.rules,"label-position":"right","label-width":"100px","label-suffix":"：",size:"small"}},[a("el-form-item",{attrs:{label:"题目形式",prop:"type"}},[a("el-radio-group",{attrs:{disabled:e.isEdit},on:{change:e.changeType},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.questionTypeList,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",{attrs:{label:"题目内容",prop:"subject"}},[a("el-input",{staticStyle:{width:"538px"},attrs:{type:"textarea",rows:"8",resize:"none",placeholder:"请输入题目内容"},model:{value:e.editForm.subject,callback:function(t){e.$set(e.editForm,"subject",t)},expression:"editForm.subject"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{label:"题目图片",prop:"photos"}},[a("div",{staticClass:"upload-box"},[a("p",{staticClass:"img-des"},[e._v(" 建议尺寸为1000*300，大小不超过10M，支持格式 png、jpg、gif ")]),a("img-upload",{ref:"imgUpload",attrs:{url:e.imgUploadUrl,onlyOne:!1,multiple:!1,size:10},on:{done:e.imgUploaded}})],1)]),"3"==e.editForm.type?a("el-form-item",{attrs:{label:"题目答案",prop:"isTrue",rules:[{required:"3"==e.editForm.type,trigger:"change",message:"请选择题目答案"}]}},[a("el-radio-group",{model:{value:e.editForm.isTrue,callback:function(t){e.$set(e.editForm,"isTrue",t)},expression:"editForm.isTrue"}},[a("el-radio",{attrs:{label:1}},[e._v("对")]),a("el-radio",{attrs:{label:0}},[e._v("错")])],1)],1):e._e(),["1","2"].includes(e.editForm.type)?a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{label:"题目选项",prop:"options",rules:[{required:["1","2"].includes(e.editForm.type),trigger:"change",validator:e.checkOptions}]}},[e._l(e.editForm.options,(function(t,s){return a("div",{key:t&&t.id||s+t+"",staticClass:"option"},["1"==e.editForm.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.optionIndex,expression:"optionIndex"}],attrs:{type:"radio",name:e.editForm.type},domProps:{value:s,checked:e._q(e.optionIndex,s)},on:{change:[function(t){e.optionIndex=s},e.changeRadio]}}):e._e(),"2"==e.editForm.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.optionIndexList,expression:"optionIndexList"}],attrs:{type:"checkbox",name:e.editForm.type},domProps:{value:s,checked:Array.isArray(e.optionIndexList)?e._i(e.optionIndexList,s)>-1:e.optionIndexList},on:{change:[function(t){var a=e.optionIndexList,i=t.target,o=!!i.checked;if(Array.isArray(a)){var n=s,r=e._i(a,n);i.checked?r<0&&(e.optionIndexList=a.concat([n])):r>-1&&(e.optionIndexList=a.slice(0,r).concat(a.slice(r+1)))}else e.optionIndexList=o},e.changeCheck]}}):e._e(),a("el-input",{staticStyle:{width:"480px"},attrs:{placeholder:"请输入"},model:{value:t.itemInfo,callback:function(a){e.$set(t,"itemInfo",a)},expression:"item.itemInfo"}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.deleteOption(s)}}})],1)})),a("div",{staticClass:"add-btn",on:{click:e.addOption}},[e._v("+ 新增选项")])],2):e._e(),a("el-form-item",{attrs:{label:"题目分析",prop:"analysis"}},[a("el-input",{staticStyle:{width:"538px"},attrs:{type:"textarea",rows:"8",resize:"none",placeholder:"请输入题目分析"},model:{value:e.editForm.analysis,callback:function(t){e.$set(e.editForm,"analysis",t)},expression:"editForm.analysis"}})],1),a("el-divider"),a("h3",[e._v("其他设置")]),a("el-form-item",{attrs:{label:"所属模块",prop:"modelIds"}},[a("el-checkbox-group",{model:{value:e.editForm.modelIds,callback:function(t){e.$set(e.editForm,"modelIds",t)},expression:"editForm.modelIds"}},e._l(e.moduleList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"所属校区",prop:"campusIds"}},[a("el-checkbox-group",{model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"用户类型",prop:"usertypeCodes"}},[a("el-checkbox-group",{model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"是否必考",prop:"isImportant"}},[a("div",{staticClass:"switch"},[a("el-switch",{ref:"switch",attrs:{width:42,"active-value":1,"inactive-value":0},model:{value:e.editForm.isImportant,callback:function(t){e.$set(e.editForm,"isImportant",t)},expression:"editForm.isImportant"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.editForm.isImportant,expression:"editForm.isImportant == 1"}],staticClass:"on",on:{click:function(t){e.editForm.isImportant=0}}},[e._v("是")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.editForm.isImportant,expression:"editForm.isImportant == 0"}],staticClass:"off",on:{click:function(t){e.editForm.isImportant=1}}},[e._v("否")])],1)])],1)],1)])},ya=[],xa=(a("c740"),{components:{ImgUpload:Tt},props:{id:String},data:function(){return{isEdit:!1,loading:!1,imgUploadUrl:window.g.uploadUrl,editForm:{id:this.id||null,type:this.$store.state.qType,subject:null,photos:[],isTrue:null,options:[{itemInfo:null,isReal:1},{itemInfo:null,isReal:0}],analysis:null,modelIds:[],campusIds:[],usertypeCodes:[],isImportant:1},rules:{type:[{required:!0,trigger:"change",message:"请选择题目形式"}],subject:[{required:!0,trigger:"change",message:"请输入题目内容"}]},detail:{},optionIndex:null,optionIndexList:[],all:[],oldVal:""}},computed:Object(O["b"])({typeList:function(e){return e.trainTypeList},moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList},questionTypeList:function(e){return e.questionTypeList}}),methods:{changeType:function(e){this.all[this.oldVal-1]=_.cloneDeep(this.editForm),this.all[this.oldVal-1].type=this.oldVal,this.$store.commit("setQType",e+""),this.editForm=this.all[e-1],this.oldVal=this.editForm.type},checkOptions:function(e,t,a){t.length<2?a(new Error("至少需要两个题目选项")):t.some((function(e){return!e.itemInfo}))?a(new Error("题目选项内容不能为空")):a()},addOption:function(){this.editForm.options.push({itemInfo:null,isReal:0})},deleteOption:function(e){this.editForm.options.splice(e,1)},imgUploaded:function(e){this.editForm.photos=e?e.map((function(e){return e.ID})):[]},changeRadio:function(){this.editForm.options.forEach((function(e){return e.isReal=0})),this.editForm.options[this.optionIndex].isReal=1},changeCheck:function(){var e=this;this.editForm.options.forEach((function(t,a){e.optionIndexList.includes(a)?t.isReal=1:t.isReal=0}))},save:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){e.loading=!0;var a=Object(Ke["a"])({},e.editForm);a.photos=e.editForm.photos.join(","),Wt(a).then((function(t){e.loading=!1,"000000"==t.code?e.$confirm("您的题目已保存成功！","保存成功",{confirmButtonText:"返回",cancelButtonText:"继续新增",showCancelButton:!e.id,type:"success"}).then((function(){e.$refs.editForm.resetFields(),e.$refs.imgUpload.reset(),e.$router.go(-1)})).catch((function(){e.$refs.editForm.resetFields(),e.$refs.imgUpload.reset(),e.editForm.options=[],e.editForm.options.splice(0,0,{itemInfo:null,isReal:1}),e.editForm.options.splice(1,0,{itemInfo:null,isReal:0}),e.optionIndex=null,e.optionIndexList=[],e.editForm.type=e.$store.state.qType})):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))},chooseAllCampus:function(){this.editForm.campusIds=this.campusList.map((function(e){return e.id}))},chooseAllUsertype:function(){this.editForm.usertypeCodes=this.userTypeList.map((function(e){return e.code}))},getDetail:function(){var e=this;this.loading=!0,aa(this.id).then((function(t){if(e.loading=!1,"000000"==t.code){var a=t.data||{};e.initDetail(a)}else e.$message({showClose:!0,type:"error",message:"获取详情失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取详情失败："+t})}))},initDetail:function(e){for(var t in this.isEdit=!0,this.editForm)this.editForm[t]=e[t]||null;"1"==e.type&&(this.optionIndex=e.options.findIndex((function(e){return 1==e.isReal}))),"2"==e.type&&(this.optionIndexList=e.options.filter((function(e){return 1==e.isReal})).map((function(e,t){return t}))),this.editForm.modelIds=e.models?e.models.map((function(e){return e.id})):[],this.editForm.campusIds=e.campuss?e.campuss.map((function(e){return e.id})):[],this.editForm.usertypeCodes=e.usertypes?e.usertypes.map((function(e){return e.code})):[],this.editForm.photos=e.photos?e.photos.split(","):[],this.$refs.imgUpload.photos=this.editForm.photos.map((function(e){return{ID:e}}))}},created:function(){this.editForm.id?this.getDetail():(this.chooseAllCampus(),this.chooseAllUsertype()),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")},mounted:function(){this.all=[_.cloneDeep(this.editForm),_.cloneDeep(this.editForm),_.cloneDeep(this.editForm)],this.all.forEach((function(e,t){e.type=t+1+""})),this.oldVal=this.editForm.type}}),Ca=xa,ka=(a("f5a3"),Object(re["a"])(Ca,wa,ya,!1,null,"4ccbbb8a",null)),Sa=ka.exports,_a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box"},[a("el-input",{staticClass:"input-box",staticStyle:{width:"160px"},attrs:{placeholder:"请输入考试名称",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")])],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.examType,callback:function(t){e.examType=t},expression:"examType"}},e._l(e.examTypeList,(function(e){return a("el-tab-pane",{key:e.value,attrs:{label:e.label,name:e.value}})})),1),a("div",{staticClass:"tab-box"},[a("span",[e._v("总计"+e._s(e.total)+"条")]),a("div",{staticClass:"right-btn"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.toAdd}},[e._v("新增")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"考试名称","show-overflow-tooltip":"",width:"260",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("h3",[e._v(e._s(t.row.name))]),"1"==e.examType?a("p",[e._v("判断（"+e._s(t.row.content.judgeNum||0)+"）、单选（"+e._s(t.row.content.singleNum||0)+"）、多选（"+e._s(t.row.content.multipleNum||0)+"）")]):e._e()]}}])}),"2"==e.examType?a("el-table-column",{attrs:{prop:"modelNames",label:"考试模块","show-overflow-tooltip":"","min-width":"340"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.contents,(function(t){return a("p",{key:t.id},[e._v(e._s(t.modelName)+"：判断（"+e._s(t.judgeNum||0)+"）、单选（"+e._s(t.singleNum||0)+"）、多选（"+e._s(t.multipleNum||0)+"）")])}))}}],null,!1,258797492)}):e._e(),a("el-table-column",{attrs:{prop:"examDate",label:"参加考试时间","show-overflow-tooltip":"",width:"240"}}),"1"==e.examType?a("el-table-column",{attrs:{prop:"modelNames",label:"题目模块","show-overflow-tooltip":"","min-width":"160",formatter:e.common.defaultFormat}}):e._e(),a("el-table-column",{attrs:{prop:"usertypeNames",label:"适用对象","show-overflow-tooltip":"","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticStyle:{"margin-bottom":"6px"}},[e._v("适用校区："+e._s(t.row.campusNames))]),a("p",[e._v("适用用户："+e._s(t.row.usertypeNames))])]}}])}),a("el-table-column",{attrs:{prop:"isUse",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"switch"},[a("el-switch",{ref:"switch",attrs:{width:54,"active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.isUse,callback:function(a){e.$set(t.row,"isUse",a)},expression:"scope.row.isUse"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1==t.row.isUse,expression:"scope.row.isUse==1"}],staticClass:"on",on:{click:function(a){return e.changeStatus(t.row)}}},[e._v("开启")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==t.row.isUse,expression:"scope.row.isUse==0"}],staticClass:"off",on:{click:function(a){return e.changeStatus(t.row)}}},[e._v("关闭")])],1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.toEdit(t.row)}}},[e._v("编辑")]),a("span",{on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")]),a("span",{on:{click:function(a){return e.toRecord(t.row)}}},[e._v("考试记录")])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)},Fa=[];function La(e){return P.postAjax({code:"url",url:"exam/pageQuery",isRep:!0,data:e})}function Da(e){return P.postAjax({code:"url",url:"exam/delete/".concat(e),isGet:!0})}function Ta(e){return P.postAjax({code:"url",url:"exam/save",isRep:!0,data:e})}function ja(e){return P.postAjax({code:"url",url:"exam/find/".concat(e),isGet:!0})}function $a(e){return P.postAjax({code:"url",url:"exam/changeStatus/".concat(e),isGet:!0})}function Ia(e){return P.postAjax({code:"url",url:"exam/examRecords",isRep:!0,data:e})}var za={data:function(){return{keyword:null,examType:"1",tableData:[],loading:!1,selectArr:[],total:0,currentPage:1,pageSize:20,sort:null,orderBy:null}},computed:Object(O["b"])({examTypeList:function(e){return e.examTypeList}}),methods:{handleClick:function(e){this.getTableData(this.currentPage,this.pageSize)},toAdd:function(){var e="1"==this.examType?"common":"stage";this.$router.push("/exam/".concat(e,"-add"))},toEdit:function(e){var t="1"==this.examType?"common":"stage";this.$router.push("/exam/".concat(t,"-edit/").concat(e.id))},toRecord:function(e){var t={id:e.id,name:e.name};sessionStorage.setItem("curExam",JSON.stringify(t)),this.$router.push("/exam/record")},changeStatus:function(e){var t=this,a=1==e.isUse?"关闭":"开启";this.$confirm("是否确认".concat(a,"考试『 ").concat(e.name," 』？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,$a(e.id).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"".concat(a,"成功！")}),t.getTableData()):t.$message({showClose:!0,type:"error",message:"".concat(a,"失败：").concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"".concat(a,"失败：").concat(e)})}))})).catch((function(){}))},deleteRow:function(e){var t=this;this.$confirm("是否确认删除考试『 ".concat(e.name," 』？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,Da(e.id).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"删除成功！"}),t.getTableData()):t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e)})}))})).catch((function(){}))},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{type:this.examType||null,name:this.keyword||null},limit:t,page:e||1};La(s).then((function(i){if(a.loading=!1,"000000"==i.code){a.tableData=i.data||[],a.tableData.forEach((function(e){e.examDate="".concat(a.moment(e.startDate,"YYYYMMDD").format("YYYY-MM-DD")," 至 ").concat(a.moment(e.endDate,"YYYYMMDD").format("YYYY-MM-DD")),e.content=e.contents[0]||{}})),a.total=i.total,a.currentPage=e||1;var o=Object(Ke["a"])(Object(Ke["a"])({},s.filter),{},{limit:t,page:e||1});sessionStorage.setItem("examParams",JSON.stringify(o))}})).catch((function(e){a.loading=!1}))},initParams:function(){var e=sessionStorage.getItem("examParams");if(e){var t=JSON.parse(e),a=t.type,s=t.name,i=t.limit,o=t.page;this.examType=a,this.keyword=s,this.pageSize=i,this.currentPage=o}}},created:function(){this.initParams(),this.getTableData(this.currentPage,this.pageSize)}},Na=za,Aa=(a("9fef"),Object(re["a"])(Na,_a,Fa,!1,null,"34e9a0f5",null)),Pa=Aa.exports,Oa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table detail"},[a("div",{staticClass:"search-box clearfix"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-popover",{attrs:{placement:"bottom-start",width:"200",trigger:"manual","visible-arrow":!1},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[a("div",{staticClass:"popover-select-box"},[a("el-input",{attrs:{placeholder:"请输入",size:"small","suffix-icon":"el-icon-search",clearable:""},on:{clear:e.getExamList},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getExamList.apply(null,arguments)}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),a("ul",[e._l(e.examList,(function(t){return a("li",{key:t.id,class:{active:e.curExamId==t.id},on:{click:function(a){return e.chooseExam(t)}}},[e._v(e._s(t.name))])})),0==e.examList.length?a("li",[e._v("暂无考试")]):e._e()],2)],1),a("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",size:"small"},on:{click:function(t){e.showPopover=!e.showPopover}},slot:"reference"},[e._v(" "+e._s(e.curExamName)+" "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1)],1),a("div",{staticClass:"tab-box"},[a("span",[e._v(e._s(e.chosenExam.answerNum||0)+"参与 · "+e._s(e.chosenExam.passNum||0)+" 合格 / "+e._s(e.chosenExam.unpassNum||0)+" 不合格 · "+e._s(100*(e.chosenExam.passRate||0))+"% 通过率")]),a("div",{staticClass:"right-btn"},[a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"年级",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},e._l(e.gradeList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"所属",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.dept,callback:function(t){e.dept=t},expression:"dept"}},e._l(e.deptList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"考试状态",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticClass:"input-box",staticStyle:{width:"160px"},attrs:{placeholder:"请输入姓名",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"姓名","show-overflow-tooltip":"",width:"100",fixed:""}}),a("el-table-column",{attrs:{prop:"readerid",label:"证件号","show-overflow-tooltip":"",width:"100",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"barcode",label:"条码","show-overflow-tooltip":"",width:"100",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"idcard",label:"身份证号","show-overflow-tooltip":"","min-width":"180"}}),a("el-table-column",{attrs:{prop:"grade",label:"年级","show-overflow-tooltip":"",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"dept",label:"所属","show-overflow-tooltip":"",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"campusName",label:"校区","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"examTime",label:"考试时间","show-overflow-tooltip":"","min-width":"140",formatter:e.common.timeFormat}}),a("el-table-column",{attrs:{prop:"score",label:"考试分数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"isPass",label:"考试状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"status",class:"status-"+t.row.isPass},[e._v(e._s("1"==t.row.isPass?"合格":"不合格"))])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)},Ea=[];function Ua(e){return P.postAjax({code:"url",url:"analysisQuestion/pageQuery",isRep:!0,data:e})}function qa(){return P.postAjax({code:"url",url:"analysisExam/override"})}function Ra(e){return P.postAjax({code:"url",url:"analysisExam/pageQueryExam",isRep:!0,data:e})}function Ma(e){return P.postAjax({code:"url",url:"analysisExam/examByGrade",data:e})}function Ba(e){return P.postAjax({code:"url",url:"analysisExam/pageQueryExamByDept",isRep:!0,data:e})}var Ya={data:function(){return{curExamId:null,curExamName:null,examList:[],showPopover:!1,query:null,keyword:null,grade:null,dept:null,status:null,statusList:[{value:0,label:"不合格"},{value:1,label:"合格"}],tableData:[],loading:!1,total:0,currentPage:1,pageSize:20,sort:null,orderBy:null,chosenExam:{}}},computed:Object(O["b"])({gradeList:function(e){return e.gradeList},deptList:function(e){return e.deptList}}),methods:{chooseExam:function(e){this.curExamId=e.id,this.curExamName=e.name,this.showPopover=!1,this.chosenExam=e||{},this.getTableData(1,this.pageSize)},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{examId:this.curExamId,grade:this.grade||null,dept:this.dept||null,isPass:""===this.status?null:this.status,name:this.keyword||null},limit:t,page:e||1};Ia(s).then((function(t){a.loading=!1,"000000"==t.code&&(a.tableData=t.data||[],a.total=t.total,a.currentPage=e||1)})).catch((function(e){a.loading=!1}))},getExamList:function(){var e=this;this.userLoading=!0;var t={filter:{name:this.query||null},limit:1e3,page:1};Ra(t).then((function(t){e.userLoading=!1,"000000"==t.code?e.examList=t.data||[]:e.examList=[],e.chosenExam=e.examList[0]||{}})).catch((function(t){e.userLoading=!1,e.examList=[]}))},initExam:function(){var e=sessionStorage.getItem("curExam");if(e){var t=JSON.parse(e);this.curExamId=t.id,this.curExamName=t.name,this.query=t.name}}},created:function(){this.initExam(),this.getExamList(),this.getTableData(this.currentPage,this.pageSize),0==this.gradeList.length&&this.$store.dispatch("getGradeList"),0==this.deptList.length&&this.$store.dispatch("getDeptList")}},Ga=Ya,Qa=(a("b815"),a("542e"),Object(re["a"])(Ga,Oa,Ea,!1,null,"1121e700",null)),Va=Qa.exports,Ja=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.editForm.id?"编辑普通考试":"新增普通考试")+" "),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")])],1)],1),a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,rules:e.rules,"label-position":"left","label-width":"100px","label-suffix":"：",size:"small"}},[a("el-form-item",{attrs:{label:"考试名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-divider"),a("h3",[e._v("考试配置")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"考试时间",prop:"examDate"}}),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"examDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyyMMdd"},model:{value:e.editForm.examDate,callback:function(t){e.$set(e.editForm,"examDate",t)},expression:"editForm.examDate"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"考试时长",prop:"duration"}}),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"duration"}},[a("div",{staticClass:"input-number"},[a("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editForm.duration,callback:function(t){e.$set(e.editForm,"duration",t)},expression:"editForm.duration"}}),a("span",{staticClass:"mm"},[e._v("分钟")])],1)])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"后可交卷",prop:"beforeSubmitTime"}}),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"beforeSubmitTime"}},[a("div",{staticClass:"input-number"},[a("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editForm.beforeSubmitTime,callback:function(t){e.$set(e.editForm,"beforeSubmitTime",t)},expression:"editForm.beforeSubmitTime"}}),a("span",{staticClass:"mm"},[e._v("分钟")])],1)])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"IP限制",prop:"isOpenip"}},[a("el-radio-group",{on:{change:e.changeIpOpen},model:{value:e.editForm.isOpenip,callback:function(t){e.$set(e.editForm,"isOpenip",t)},expression:"editForm.isOpenip"}},[a("el-radio",{attrs:{label:0}},[e._v("不限制")]),a("el-radio",{attrs:{label:1}},[e._v("开启限制")])],1)],1)],1),"1"==e.editForm.isOpenip?a("el-col",{attrs:{span:12}},[a("div",{staticClass:"ip-box"},[a("el-form-item",{attrs:{prop:"ipStart"}},[a("el-input",{attrs:{placeholder:"IP地址",size:"small"},model:{value:e.editForm.ipStart,callback:function(t){e.$set(e.editForm,"ipStart",t)},expression:"editForm.ipStart"}})],1),a("span",[e._v("~")]),a("el-form-item",{attrs:{prop:"ipEnd"}},[a("el-input",{attrs:{placeholder:"IP地址",size:"small"},model:{value:e.editForm.ipEnd,callback:function(t){e.$set(e.editForm,"ipEnd",t)},expression:"editForm.ipEnd"}})],1)],1)]):e._e()],1),a("el-form-item",{staticStyle:{"margin-left":"10px"},attrs:{label:"需要学习",prop:"needLearn"}},[a("div",{staticClass:"input-number",staticStyle:{width:"270px"}},[a("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editForm.needLearn,callback:function(t){e.$set(e.editForm,"needLearn",t)},expression:"editForm.needLearn"}}),a("span",{staticClass:"mm"},[e._v("分钟")])],1)]),a("h3",{staticStyle:{"margin-top":"30px"}},[e._v("适用对象")]),a("el-form-item",{attrs:{label:"适用校区",prop:"campusIds"}},[a("el-checkbox-group",{on:{change:e.debouncePoolData},model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"适用用户",prop:"usertypeCodes"}},[a("el-checkbox-group",{on:{change:e.debouncePoolData},model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1),a("el-divider"),a("h3",[e._v("组卷信息")]),a("el-form-item",{attrs:{label:"题目模块",prop:"modelIds"}},[a("el-checkbox-group",{on:{change:e.debouncePoolData},model:{value:e.editForm.modelIds,callback:function(t){e.$set(e.editForm,"modelIds",t)},expression:"editForm.modelIds"}},e._l(e.moduleList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.questionLoading,expression:"questionLoading"}],attrs:{gutter:6}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"判断题",prop:"content.judgeNum","label-width":"80px",required:"","show-message":!1}},[a("question-tips",{ref:"judgePool",attrs:{multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length,data:e.poolData,type:"3"}})],1),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"judgeNum"}},[a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:e.judgePoolMax},on:{change:e.calcTotalScore},model:{value:e.editForm.content.judgeNum,callback:function(t){e.$set(e.editForm.content,"judgeNum",t)},expression:"editForm.content.judgeNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0},on:{change:e.calcTotalScore},model:{value:e.editForm.content.judgeScore,callback:function(t){e.$set(e.editForm.content,"judgeScore",t)},expression:"editForm.content.judgeScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"单选题",prop:"content.singleNum","label-width":"80px",required:"","show-message":!1}},[a("question-tips",{ref:"singlePool",attrs:{multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length,data:e.poolData,type:"1"}})],1),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"singleNum"}},[a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:e.singlePoolMax},on:{change:e.calcTotalScore},model:{value:e.editForm.content.singleNum,callback:function(t){e.$set(e.editForm.content,"singleNum",t)},expression:"editForm.content.singleNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0},on:{change:e.calcTotalScore},model:{value:e.editForm.content.singleScore,callback:function(t){e.$set(e.editForm.content,"singleScore",t)},expression:"editForm.content.singleScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"多选题",prop:"content.multipleNum","label-width":"80px",required:"","show-message":!1}},[a("question-tips",{ref:"multiplePool",attrs:{multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length,data:e.poolData,type:"2"}})],1),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"multipleNum"}},[a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:e.multiplePoolMax},on:{change:e.calcTotalScore},model:{value:e.editForm.content.multipleNum,callback:function(t){e.$set(e.editForm.content,"multipleNum",t)},expression:"editForm.content.multipleNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0},on:{change:e.calcTotalScore},model:{value:e.editForm.content.multipleScore,callback:function(t){e.$set(e.editForm.content,"multipleScore",t)},expression:"editForm.content.multipleScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"总分",prop:"totalScore"}}),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"totalScore"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editForm.content.totalScore,callback:function(t){e.$set(e.editForm.content,"totalScore",t)},expression:"editForm.content.totalScore"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"合格分",prop:"qualifiedScore"}}),a("el-form-item",{staticStyle:{"margin-left":"-100px"},attrs:{prop:"qualifiedScore"}},[a("div",{staticClass:"input-number"},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:e.editForm.content.totalScore},model:{value:e.editForm.content.qualifiedScore,callback:function(t){e.$set(e.editForm.content,"qualifiedScore",t)},expression:"editForm.content.qualifiedScore"}}),a("span",{staticClass:"mm"},[e._v("分")])],1)])],1)],1)],1)],1)])},Ha=[],Ka=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"question-tips"},[e._t("default"),a("el-popover",{attrs:{"popper-class":"question-tips-popper",placement:"bottom-start",title:e.title,trigger:"hover"}},[a("el-table",{staticClass:"small-table",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"campusName",label:"校区/用户","show-overflow-tooltip":"",fixed:"","min-width":"100"}}),e._l(Object.keys(e.usertypes),(function(t){return a("el-table-column",{key:t,attrs:{prop:t,label:t,"show-overflow-tooltip":"","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("span",{class:{active:s.row[t]==e.minNum}},[e._v(e._s(s.row[t]))])]}}],null,!0)})}))],2),a("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})],1),a("span",{staticClass:"tips"},[e._v("最多"+e._s(e.minNum)+"题")])],2)},Xa=[],Wa=a("2909"),Za={props:{type:String,data:Array,multi:Number},computed:{title:function(){var e="";switch(this.type){case"1":e="单选题池";break;case"2":e="多选题池";break;case"3":e="判断题池";break}return e},typeData:function(){var e=this;return this.data.filter((function(t){return t.type==e.type}))},campus:function(){for(var e={},t=0;t<this.typeData.length;t++){var a=this.typeData[t];e["campus-".concat(a.campusId)]||(e["campus-".concat(a.campusId)]=a.campusName)}return e},usertypes:function(){for(var e={},t=0;t<this.typeData.length;t++){var a=this.typeData[t];e["".concat(a.usertypeName)]||(e["".concat(a.usertypeName)]=a.usertypeCode)}return e},tableData:function(){var e=[];for(var t in this.campus){for(var a={campusName:this.campus[t]},s=0;s<this.typeData.length;s++){var i=this.typeData[s];t=="campus-".concat(i.campusId)&&(a["".concat(i.usertypeName)]=i.num)}e.push(a)}return e},minNum:function(){var e=this.typeData.map((function(e){return e.num}));return e.length<this.multi?0:e.length>0?Math.min.apply(Math,Object(Wa["a"])(e)):0}}},es=Za,ts=(a("3071"),a("f357"),Object(re["a"])(es,Ka,Xa,!1,null,"4b4adb3e",null)),as=ts.exports,ss=a("53ca"),is=(a("7db0"),a("4ec9"),a("c1df")),os=a.n(is),ns=a("692d"),rs={defaultFormat:function(e,t,a){return a||"--"},timeFormat:function(e,t,a,s,i){if(a){var o=i||"YYYY-MM-DD HH:mm";return os()(a,"YYYYMMDDHHmmss").format(o)}return"--"},defaultTimeFormat:function(e,t){if(e){var a=t||"YYYY-MM-DD HH:mm";return os()(e,"YYYYMMDDHHmmss").format(a)}return"--"},add:function(e,t,a){var s=e||0,i=t||0;return a?ns.round(ns.add(s.toString(),i.toString()),a):ns.add(s.toString(),i.toString())},subtract:function(e,t,a){var s=e||0,i=t||0;return a?ns.round(ns.subtract(s.toString(),i.toString()),a):ns.subtract(s.toString(),i.toString())},multiply:function(e,t,a){var s=e||0,i=t||0;return a?ns.round(ns.multiply(s.toString(),i.toString()),a):ns.multiply(s.toString(),i.toString())},divide:function(e,t,a){var s=a||4,i=e||0,o=t||1;return ns.divide(i.toString(),o.toString(),s)},moneyFormat:function(e){var t="";return e?(t=ns.round(e.toString(),2),ns.getPrettyValue(t)):"--"},moneyInput:function(e){e.target.value=e.target.value.replace(/[^\d.]/g,""),e.target.value=e.target.value.replace(/\.{2,}/g,"."),e.target.value=e.target.value.replace(/^\./g,"0."),e.target.value=e.target.value.replace(/^\d*\.\d*\./g,e.target.value.substring(0,e.target.value.length-1)),e.target.value=e.target.value.replace(/^0[^\.]+/g,""),e.target.value=e.target.value.replace(/^(\d+)\.(\d\d).*$/,"$1.$2")},downloadFile:function(e){window.location.href=window.g.downUrl+e},reviewFile:function(e){window.location.href=window.g.viewUrl+e},learnTypeFormat:function(e){var t=ae.state.trainTypeList,a=t.find((function(t){return t.value==e}))||{};return a.label||"--"},learnSizeFormat:function(e){return e<1024?this.divide(e,1,1)+"B":e<1048576?this.divide(e,1024,1)+"KB":e<1073741824?this.divide(e,1048576,1)+"M":this.divide(e,1073741824,1)+"G"},debounce:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,a=null;return function(){var s=arguments,i=this;a&&clearTimeout(a),a=setTimeout((function(){e.apply(i,s)}),t)}},throttle:function(e){var t,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){var i=this,o=arguments,n=+new Date;t&&n-t<s?(clearTimeout(a),itmer=setTimeout((function(){t=n,e.apply(i,o)}),s)):(t=n,e.apply(this,o))}},deepClone:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if("object"!==Object(ss["a"])(e))return e;var a=Array.isArray(e)?[]:{};if(t.get(e))return t.get(e);for(var s in t.set(e,a),e)e.hasOwnProperty(s)&&(a[s]=this.deepClone(e[s],t));return a}},ls=void 0,cs={components:{QuestionTips:as},props:{id:String},data:function(){var e=this,t=/^(?:(?:2[0-4][0-9]\.)|(?:25[0-5]\.)|(?:1[0-9][0-9]\.)|(?:[1-9][0-9]\.)|(?:[0-9]\.)){3}(?:(?:2[0-4][0-9])|(?:25[0-5])|(?:1[0-9][0-9])|(?:[1-9][0-9])|(?:[0-9]))$/,a=function(a,s,i){if(s){if(t.test(s)){if(e.editForm.ipEnd&&e.editForm.ipStart){var o=e.editForm.ipStart.split("."),n=e.editForm.ipEnd.split("."),r=o.slice(0,3).join("."),l=n.slice(0,3).join(".");return r!==l||o[3]>n[3]?i(new Error("IP地址范围不符合规范!")):i()}return i()}return i(new Error("请输入正确的IP地址!"))}return i(new Error("请输入IP地址!"))};return{loading:!1,editForm:{id:this.id||null,type:"1",name:null,examDate:null,duration:0,beforeSubmitTime:0,isOpenip:0,ipStart:null,ipEnd:null,needLearn:0,campusIds:[],usertypeCodes:[],modelIds:[],content:{judgeNum:0,judgeScore:0,multipleNum:0,multipleScore:0,singleNum:0,singleScore:0,totalScore:0,qualifiedScore:0}},rules:{name:[{required:!0,trigger:"change",message:"请输入考试名称"}],examDate:[{required:!0,trigger:"change",message:"请选择考试时间"}],isOpenip:[{required:!0,trigger:"change",message:"请选择IP限制"}],ipStart:[{required:!0,validator:a,trigger:"change"}],ipEnd:[{required:!0,validator:a,trigger:"change"}],campusIds:[{required:!0,trigger:"change",message:"请选择适用校区"}],usertypeCodes:[{required:!0,trigger:"change",message:"请选择适用用户"}],modelIds:[{required:!0,trigger:"change",message:"请选择题目模块"}]},detail:{},poolData:[],questionLoading:!1,judgePoolMax:0,singlePoolMax:0,multiplePoolMax:0}},computed:Object(O["b"])({typeList:function(e){return e.trainTypeList},moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList},questionTypeList:function(e){return e.questionTypeList},multi:function(){if(ls&&ls.editForm)return ls.editForm.campusIds.length*ls.editForm.usertypeCodes.length}}),methods:{changeIpOpen:function(e){0==e&&(this.editForm.ipStart=null,this.editForm.ipEnd=null)},save:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){var a=Object(Ke["a"])({},e.editForm);if(a.startDate=e.editForm.examDate[0],a.endDate=e.editForm.examDate[1],a.contents=[e.editForm.content],!(a.content.judgeNum+a.content.multipleNum+a.content.singleNum))return void e.$message({type:"warning",message:"没有设置题目！",showClose:!0});e.loading=!0,Ta(a).then((function(t){e.loading=!1,"000000"==t.code?e.editForm.id?e.$message({showClose:!0,type:"success",message:"保存成功！"}):e.$confirm("普通考试保存成功！","保存成功",{confirmButtonText:"返回",cancelButtonText:"继续新增",showCancelButton:!e.id,type:"success"}).then((function(){e.$router.go(-1)})).catch((function(){e.$refs.editForm.resetFields(),e.resetData()})):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))},resetData:function(){this.poolData=[],this.editForm.examDate=null,this.editForm.content.judgeScore=0,this.editForm.content.singleScore=0,this.editForm.content.multipleScore=0,this.editForm.content.qualifiedScore=0},chooseAllCampus:function(){this.editForm.campusIds=this.campusList.map((function(e){return e.id}))},chooseAllUsertype:function(){this.editForm.usertypeCodes=this.userTypeList.map((function(e){return e.code}))},debouncePoolData:rs.debounce((function(){this.getPoolData()}),1e3),dyQueNum:function(e,t){this.editForm.content[e]>t&&this.$set(this.editForm.content,e,t)},getPoolData:function(){var e=this;this.questionLoading=!0;var t={campusIds:this.editForm.campusIds,modelIds:this.editForm.modelIds,usertypeCodes:this.editForm.usertypeCodes};return ta(t).then((function(t){return"000000"==t.code?(e.poolData=t.data||[],e.$nextTick((function(){e.judgePoolMax=e.$refs.judgePool.minNum||0,e.singlePoolMax=e.$refs.singlePool.minNum||0,e.multiplePoolMax=e.$refs.multiplePool.minNum||0,e.dyQueNum("judgeNum",e.judgePoolMax),e.dyQueNum("singleNum",e.singlePoolMax),e.dyQueNum("multipleNum",e.multiplePoolMax)})),e.questionLoading=!1,Promise.resolve()):(e.poolData=[],e.multiplePoolMax=0,e.singlePoolMax=0,e.judgePoolMax=0,e.dyQueNum("judgeNum",e.judgePoolMax),e.dyQueNum("singleNum",e.singlePoolMax),e.dyQueNum("multipleNum",e.multiplePoolMax),e.questionLoading=!1,Promise.reject())})).catch((function(t){return e.poolData=[],e.multiplePoolMax=0,e.singlePoolMax=0,e.judgePoolMax=0,e.questionLoading=!1,Promise.reject()}))},calcTotalScore:function(){var e=this.editForm.content,t=e.judgeNum,a=e.judgeScore,s=e.singleNum,i=e.singleScore,o=e.multipleNum,n=e.multipleScore;this.editForm.content.totalScore=parseInt(this.common.multiply(t,a))+parseInt(this.common.multiply(s,i))+parseInt(this.common.multiply(o,n))},getDetail:function(){var e=this;this.loading=!0,ja(this.id).then((function(t){if(e.loading=!1,"000000"==t.code){var a=t.data||{};e.initDetail(a)}else e.$message({showClose:!0,type:"error",message:"获取详情失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取详情失败："+t})}))},initDetail:function(e){var t=this;for(var a in e)this.editForm[a]=e[a];this.editForm.examDate=[e.startDate,e.endDate],this.editForm.modelIds=e.models?e.models.map((function(e){return e.id})):[],this.editForm.campusIds=e.campuss?e.campuss.map((function(e){return e.id})):[],this.editForm.usertypeCodes=e.usertypes?e.usertypes.map((function(e){return e.code})):[],this.getPoolData().then((function(){var a=e.contents[0];a&&(t.editForm.content=a)}))}},created:function(){this.editForm.id?this.getDetail():(this.chooseAllCampus(),this.chooseAllUsertype()),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},us=cs,ds=(a("f9ec"),a("9e48"),Object(re["a"])(us,Ja,Ha,!1,null,"293cc545",null)),ps=ds.exports,ms=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.editForm.id?"编辑闯关考试":"新增闯关考试")+" "),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("保存")])],1)],1),a("div",{staticClass:"form-box"},[a("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.editForm,rules:e.rules,"label-position":"left","label-width":"100px","label-suffix":"：",size:"small"}},[a("div",{staticStyle:{width:"640px",margin:"0 auto"}},[a("el-form-item",{attrs:{label:"考试名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-divider"),a("h3",[e._v("考试配置")]),a("el-form-item",{attrs:{label:"考试时间",prop:"examDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyyMMdd"},model:{value:e.editForm.examDate,callback:function(t){e.$set(e.editForm,"examDate",t)},expression:"editForm.examDate"}})],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"IP限制",prop:"isOpenip"}},[a("el-radio-group",{on:{change:e.changeIpOpen},model:{value:e.editForm.isOpenip,callback:function(t){e.$set(e.editForm,"isOpenip",t)},expression:"editForm.isOpenip"}},[a("el-radio",{attrs:{label:0}},[e._v("不限制")]),a("el-radio",{attrs:{label:1}},[e._v("开启限制")])],1)],1)],1),"1"==e.editForm.isOpenip?a("el-col",{attrs:{span:12}},[a("div",{staticClass:"ip-box"},[a("el-form-item",{attrs:{prop:"ipStart"}},[a("el-input",{attrs:{placeholder:"IP地址",size:"small"},model:{value:e.editForm.ipStart,callback:function(t){e.$set(e.editForm,"ipStart",t)},expression:"editForm.ipStart"}})],1),a("span",[e._v("~")]),a("el-form-item",{attrs:{prop:"ipEnd"}},[a("el-input",{attrs:{placeholder:"IP地址",size:"small"},model:{value:e.editForm.ipEnd,callback:function(t){e.$set(e.editForm,"ipEnd",t)},expression:"editForm.ipEnd"}})],1)],1)]):e._e()],1),a("h3",{staticStyle:{"margin-top":"30px"}},[e._v("适用对象")]),a("el-form-item",{attrs:{label:"适用校区",prop:"campusIds"}},[a("el-checkbox-group",{on:{change:e.debounceContentsPoolData},model:{value:e.editForm.campusIds,callback:function(t){e.$set(e.editForm,"campusIds",t)},expression:"editForm.campusIds"}},e._l(e.campusList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"适用用户",prop:"usertypeCodes"}},[a("el-checkbox-group",{on:{change:e.debounceContentsPoolData},model:{value:e.editForm.usertypeCodes,callback:function(t){e.$set(e.editForm,"usertypeCodes",t)},expression:"editForm.usertypeCodes"}},e._l(e.userTypeList,(function(t){return a("el-checkbox",{key:t.code,attrs:{label:t.code}},[e._v(e._s(t.name))])})),1)],1),a("el-divider"),a("div",{staticClass:"stage-title"},[a("h3",[e._v(" 关卡信息 "),a("span",{staticClass:"tips"},[a("i",{staticClass:"el-icon-warning"}),e._v(" 通过所有关卡后激活借书证 ")])]),a("el-form-item",{staticClass:"right-item",attrs:{prop:"isOrder"}},[a("div",{staticClass:"switch"},[a("el-switch",{ref:"switch",attrs:{width:54,"active-value":1,"inactive-value":0},model:{value:e.editForm.isOrder,callback:function(t){e.$set(e.editForm,"isOrder",t)},expression:"editForm.isOrder"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.editForm.isOrder,expression:"editForm.isOrder==1"}],staticClass:"on",on:{click:function(t){e.editForm.isOrder=0}}},[e._v("开启")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.editForm.isOrder,expression:"editForm.isOrder==0"}],staticClass:"off",on:{click:function(t){e.editForm.isOrder=1}}},[e._v("关闭")])],1),a("span",{staticStyle:{color:"#5F6464","margin-left":"10px"}},[e._v("按关卡顺序闯关")])])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.questionLoading,expression:"questionLoading"}],staticClass:"stage-table"},[a("el-row",{staticClass:"head",attrs:{gutter:6}},[a("el-col",{attrs:{span:1}},[e._v("关卡")]),a("el-col",{attrs:{span:6}},[e._v("判断题")]),a("el-col",{attrs:{span:6}},[e._v("单选题")]),a("el-col",{attrs:{span:6}},[e._v("多选题")]),a("el-col",{attrs:{span:2}},[e._v("合格分")]),a("el-col",{attrs:{span:3}},[e._v("需要学习")])],1),e._l(e.contents,(function(t,s){return a("el-row",{key:t.modelId,staticClass:"body",attrs:{gutter:6}},[a("el-col",{attrs:{span:1}},[e._v(e._s(s+1))]),a("el-col",{attrs:{span:6}},[a("question-tips",{ref:"judgePool",refInFor:!0,attrs:{data:t.poolData,type:"3",multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length}},[a("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.modelName))])]),a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.maxJudgeNum,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.judgeNum,callback:function(a){e.$set(t,"judgeNum",a)},expression:"item.judgeNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.judgeScore,callback:function(a){e.$set(t,"judgeScore",a)},expression:"item.judgeScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)],1),a("el-col",{attrs:{span:6}},[a("question-tips",{ref:"singlePool",refInFor:!0,attrs:{data:t.poolData,type:"1",multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length}}),a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.maxSingleNum,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.singleNum,callback:function(a){e.$set(t,"singleNum",a)},expression:"item.singleNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.singleScore,callback:function(a){e.$set(t,"singleScore",a)},expression:"item.singleScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)],1),a("el-col",{attrs:{span:6}},[a("question-tips",{ref:"multiplePool",refInFor:!0,attrs:{data:t.poolData,type:"2",multi:e.editForm.campusIds.length*e.editForm.usertypeCodes.length}}),a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.maxMultipleNum,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.multipleNum,callback:function(a){e.$set(t,"multipleNum",a)},expression:"item.multipleNum"}}),a("span",{staticClass:"mm"},[e._v("题")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},on:{change:function(t){return e.calcTotalScore(s)}},model:{value:t.multipleScore,callback:function(a){e.$set(t,"multipleScore",a)},expression:"item.multipleScore"}}),a("span",{staticClass:"mm"},[e._v("分/题")])],1)],1),a("el-col",{attrs:{span:5}},[a("p",{staticStyle:{color:"#999"}},[e._v("总分："+e._s(t.totalScore))]),a("div",{staticClass:"input-number half",staticStyle:{"margin-right":"10px"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,max:t.totalScore,size:"small"},model:{value:t.qualifiedScore,callback:function(a){e.$set(t,"qualifiedScore",a)},expression:"item.qualifiedScore"}}),a("span",{staticClass:"mm"},[e._v("分")])],1),a("div",{staticClass:"input-number half"},[a("el-input-number",{attrs:{"controls-position":"right",min:0,size:"small"},model:{value:t.needLearn,callback:function(a){e.$set(t,"needLearn",a)},expression:"item.needLearn"}}),a("span",{staticClass:"mm"},[e._v("分钟")])],1)])],1)}))],2)])],1)])},fs=[],hs={components:{QuestionTips:as},props:{id:String},data:function(){var e=this,t=/^(?:(?:2[0-4][0-9]\.)|(?:25[0-5]\.)|(?:1[0-9][0-9]\.)|(?:[1-9][0-9]\.)|(?:[0-9]\.)){3}(?:(?:2[0-4][0-9])|(?:25[0-5])|(?:1[0-9][0-9])|(?:[1-9][0-9])|(?:[0-9]))$/,a=function(a,s,i){if(s){if(t.test(s)){if(e.editForm.ipEnd&&e.editForm.ipStart){var o=e.editForm.ipStart.split("."),n=e.editForm.ipEnd.split("."),r=o.slice(0,3).join("."),l=n.slice(0,3).join(".");return r!==l||o[3]>n[3]?i(new Error("IP地址范围不符合规范!")):i()}return i()}return i(new Error("请输入正确的IP地址!"))}return i(new Error("请输入IP地址!"))};return{loading:!1,editForm:{id:this.id||null,type:"2",name:null,examDate:null,isOpenip:0,ipStart:null,ipEnd:null,campusIds:[],usertypeCodes:[],isOrder:1},rules:{name:[{required:!0,trigger:"change",message:"请输入考试名称"}],examDate:[{required:!0,trigger:"change",message:"请选择考试时间"}],isOpenip:[{required:!0,trigger:"change",message:"请选择IP限制"}],ipStart:[{required:!0,validator:a,trigger:"change"}],ipEnd:[{required:!0,validator:a,trigger:"change"}],campusIds:[{required:!0,trigger:"change",message:"请选择适用校区"}],usertypeCodes:[{required:!0,trigger:"change",message:"请选择适用用户"}]},detail:{},questionLoading:!1,content:{maxJudgeNum:0,judgeNum:0,judgeScore:0,maxMultipleNum:0,multipleNum:0,multipleScore:0,maxSingleNum:0,singleNum:0,singleScore:0,totalScore:0,qualifiedScore:0,needLearn:0,poolData:[]},contents:[]}},computed:Object(O["b"])({moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList}}),methods:{changeIpOpen:function(e){0==e&&(this.editForm.ipStart=null,this.editForm.ipEnd=null)},save:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){var a=Object(Ke["a"])({},e.editForm);if(a.startDate=e.editForm.examDate[0],a.endDate=e.editForm.examDate[1],a.contents=[],e.contents.forEach((function(e){if(e.judgeNum+e.multipleNum+e.singleNum>0){var t={};for(var s in e)"poolData"!==s&&(t[s]=e[s]);a.contents.push(t)}})),!a.contents.length)return void e.$message({type:"warning",message:"没有设置题目！",showClose:!0});e.loading=!0,Ta(a).then((function(t){e.loading=!1,"000000"==t.code?e.editForm.id?e.$message({showClose:!0,type:"success",message:"保存成功！"}):e.$confirm("闯关考试保存成功！","保存成功",{confirmButtonText:"返回",cancelButtonText:"继续新增",showCancelButton:!e.id,type:"success"}).then((function(){e.$router.go(-1)})).catch((function(){e.$refs.editForm.resetFields(),e.resetData()})):e.$message({showClose:!0,type:"error",message:"保存失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))},resetData:function(){this.editForm.examDate=null,this.initContents()},chooseAllCampus:function(){this.editForm.campusIds=this.campusList.map((function(e){return e.id}))},chooseAllUsertype:function(){this.editForm.usertypeCodes=this.userTypeList.map((function(e){return e.code}))},getPoolData:function(e){var t=this;return this.questionLoading=!0,new Promise((function(a,s){var i={campusIds:t.editForm.campusIds,modelIds:[e],usertypeCodes:t.editForm.usertypeCodes};ta(i).then((function(e){if(t.questionLoading=!1,"000000"==e.code){var i=e.data||[];a(i)}else s([])})).catch((function(e){t.questionLoading=!1,s([])}))}))},initContents:function(){this.contents=[];for(var e=0;e<this.moduleList.length;e++){var t=this.moduleList[e];this.contents.push(Object(Ke["a"])({modelId:t.id,modelName:t.name},this.content))}this.resetContentsPoolData()},debounceContentsPoolData:rs.debounce((function(){this.resetContentsPoolData()}),1e3),dySet:function(e,t,a){e[t]>a&&this.$set(e,t,a)},resetContentsPoolData:function(){var e=this;return Object(St["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=regeneratorRuntime.mark((function t(a){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.moduleList[a]||{},t.next=3,e.getPoolData(s.id);case 3:i=t.sent,e.contents[a].poolData=i,e.$nextTick((function(){e.contents[a].maxJudgeNum=e.$refs.judgePool[a]&&e.$refs.judgePool[a].minNum||0,e.contents[a].maxSingleNum=e.$refs.singlePool[a]&&e.$refs.singlePool[a].minNum||0,e.contents[a].maxMultipleNum=e.$refs.multiplePool[a]&&e.$refs.multiplePool[a].minNum||0,e.dySet(e.contents[a],"judgeNum",e.$refs.judgePool[a]&&e.$refs.judgePool[a].minNum||0),e.dySet(e.contents[a],"singleNum",e.$refs.singlePool[a]&&e.$refs.singlePool[a].minNum||0),e.dySet(e.contents[a],"multipleNum",e.$refs.multiplePool[a]&&e.$refs.multiplePool[a].minNum||0)}));case 6:case"end":return t.stop()}}),t)})),s=0;case 2:if(!(s<e.contents.length)){t.next=7;break}return t.delegateYield(a(s),"t0",4);case 4:s++,t.next=2;break;case 7:case"end":return t.stop()}}),t)})))()},calcTotalScore:function(e){var t=this.contents[e],a=t.judgeNum,s=t.judgeScore,i=t.singleNum,o=t.singleScore,n=t.multipleNum,r=t.multipleScore;this.contents[e].totalScore=parseInt(this.common.multiply(a,s))+parseInt(this.common.multiply(i,o))+parseInt(this.common.multiply(n,r))},getDetail:function(){var e=this;this.loading=!0,ja(this.id).then((function(t){if(e.loading=!1,"000000"==t.code){var a=t.data||{};e.initDetail(a)}else e.$message({showClose:!0,type:"error",message:"获取详情失败："+t.msg})})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取详情失败："+t})}))},initDetail:function(e){var t=this;for(var a in e)this.editForm[a]=e[a];this.editForm.examDate=[e.startDate,e.endDate],this.editForm.campusIds=e.campuss?e.campuss.map((function(e){return e.id})):[],this.editForm.usertypeCodes=e.usertypes?e.usertypes.map((function(e){return e.code})):[];var s=e.contents&&e.contents.filter((function(e){return(e.modelId||0===e.modelId)&&e.modelName}));this.contents=s.map((function(e){return Object(Ke["a"])(Object(Ke["a"])({},e),{},{poolData:[]})}))||[];for(var i=this.moduleList.filter((function(e){return!t.contents.some((function(t){return t.modelId===e.id}))})),o=0;o<i.length;o++){var n=i[o];this.contents.push(Object(Ke["a"])({modelId:n.id,modelName:n.name},this.content))}this.resetContentsPoolData()}},created:function(){0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList"),this.editForm.id?this.getDetail():(this.chooseAllCampus(),this.chooseAllUsertype(),this.initContents())}},gs=hs,bs=(a("0537"),a("d4c1"),Object(re["a"])(gs,ms,fs,!1,null,"8b808924",null)),vs=bs.exports,ws=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix",staticStyle:{padding:"15px 20px 0"}},[a("h3",{staticStyle:{width:"120px"}},[e._v("用户管理")]),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"选择年级",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},e._l(e.gradeList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"选择状态",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticClass:"input-box",staticStyle:{width:"190px"},attrs:{placeholder:"请输入姓名或证件号查询",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.activeUsers("all")}}},[e._v("批量激活")]),a("el-dropdown",{on:{command:e.downTemplate}},[a("el-button",{staticClass:"bule-border",attrs:{size:"small"}},[e._v(" 模板下载 "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"new"}},[e._v("新生导入模板")]),a("el-dropdown-item",{attrs:{command:"sync"}},[e._v("同步导入模板")])],1)],1),a("el-dropdown",{on:{command:e.upload}},[a("el-button",{staticClass:"bule-border",attrs:{size:"small"}},[e._v(" 导入用户 "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"new"}},[e._v("新生导入")]),a("el-dropdown-item",{attrs:{command:"sync"}},[e._v("同步导入")])],1)],1),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.exportData}},[e._v("导出")])],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"},on:{"selection-change":e.selectRows}},[a("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.selectable}}),a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"姓名","show-overflow-tooltip":"",width:"100",fixed:""}}),a("el-table-column",{attrs:{prop:"readerid",label:"证件号","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"barcode",label:"条码","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"idcard",label:"身份证号","show-overflow-tooltip":"",width:"180"}}),a("el-table-column",{attrs:{prop:"grade",label:"年级","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"dept",label:"所属","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"campusname",label:"校区","show-overflow-tooltip":"",width:"120"}}),e.openNewbornLogin?a("el-table-column",{attrs:{prop:"qqcard",label:"QQ","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}):e._e(),e.openNewbornLogin?a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}):e._e(),e.openNewbornLogin?a("el-table-column",{attrs:{prop:"mobile",label:"手机号","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat}}):e._e(),a("el-table-column",{attrs:{prop:"sex",label:"性别","show-overflow-tooltip":"",width:"120",formatter:e.common.defaultFormat},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("0"==t.row.sex?"男":"女"))]}}])}),a("el-table-column",{attrs:{prop:"usertypename",label:"用户类型","show-overflow-tooltip":"",width:"120"}}),a("el-table-column",{attrs:{prop:"readerflag",label:"状态","show-overflow-tooltip":"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"status",class:"status-"+t.row.readerflag},[e._v(e._s(t.row.statusObj&&t.row.statusObj.label))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"right",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{directives:[{name:"show",rawName:"v-show",value:"2"==t.row.status,expression:"scope.row.status == '2'"}],on:{click:function(a){return e.activeUsers("one",t.row)}}},[e._v("激活")]),a("span",{staticStyle:{float:"right"},on:{click:function(a){return e.toRecord(t.row)}}},[e._v("考试记录")])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1),a("upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{multiple:!1,size:5120,exts:"xls|XLS|xlsx|XLSX",url:e.uploadUrl},on:{done:e.uploaded,choose:function(t){e.loading=!0}}})],1)},ys=[],xs={components:{Upload:fa},data:function(){return{grade:null,status:null,keyword:null,tableData:[],loading:!1,selectArr:[],total:0,currentPage:1,pageSize:20,sort:null,orderBy:null,uploadUrl:window.g.url+"user/importNewStu"}},computed:Object(O["b"])({statusList:function(e){return e.userStatusList},gradeList:function(e){return e.gradeList},openNewbornLogin:function(e){return e.newbornLogin}}),methods:{selectable:function(e,t){return"3"==e.statusObj.value},selectRows:function(e){this.selectArr=e},activeUsers:function(e,t){var a=this;if("all"!=e||0!=this.selectArr.length){this.loading=!0;var s="all"==e?this.selectArr.map((function(e){return e.id})):[t.id];ee(s).then((function(e){a.loading=!1,"000000"==e.code?(a.$message({showClose:!0,type:"success",message:"激活成功！"}),a.getTableData(a.currentPage,a.pageSize)):a.$message({showClose:!0,type:"error",message:"激活失败："+e.msg})})).catch((function(e){a.loading=!1,a.$message({showClose:!0,type:"error",message:"激活失败："+e})}))}else this.$message({showClose:!0,type:"error",message:"请选择需要激活的用户！"})},downTemplate:function(e){var t="".concat(window.g.url,"new"==e?"user/downloadNewStuTemplate":"user/downloadSyncStuTemplate");window.open(t,"_blank")},upload:function(e){this.uploadUrl="".concat(window.g.url,"new"==e?"user/importNewStu":"user/importSyncStu"),this.$refs.upload.toupload()},uploaded:function(e){if(this.loading=!1,"000000"==e.code){var t=e.data;if(t.importFlag||t.flag)this.$message({showClose:!0,message:"导入成功！",type:"success"}),this.getTableData(1,this.pageSize);else{var a="",s=t.errors||{};for(var i in s)a+="第".concat(i,"行：").concat(s[i])+"\n";this.$message({showClose:!0,message:"导入失败：\n"+a,type:"error"})}}else this.$message({showClose:!0,message:"导入失败："+e.msg,type:"error"})},exportData:function(){var e={};this.util.exportFile("user/exportUsers",!1,e,"导出用户","xlsx")},toRecord:function(e){this.$router.push("/sys-setting/users/record/".concat(e.id)),sessionStorage.setItem("curRecordUserName",e.name)},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{grade:this.grade||null,readerflag:this.status||null,keyword:this.keyword||null},limit:t,page:e||1};X(s).then((function(i){if(a.loading=!1,"000000"==i.code){a.tableData=i.data||[],a.total=i.total,a.currentPage=e||1,a.tableData.forEach((function(e){var t=a.statusList.find((function(t){return t.value==e.readerflag}));a.$set(e,"statusObj",t)}));var o=Object(Ke["a"])(Object(Ke["a"])({},s.filter),{},{limit:t,page:e||1});sessionStorage.setItem("userParams",JSON.stringify(o))}})).catch((function(e){a.loading=!1}))},initParams:function(){var e=sessionStorage.getItem("userParams");if(e){var t=JSON.parse(e);this.grade=t.grade,this.status=t.readerflag,this.keyword=t.keyword,this.pageSize=t.limit,this.currentPage=t.page}}},created:function(){this.initParams(),this.getTableData(this.currentPage,this.pageSize),0==this.gradeList.length&&this.$store.dispatch("getGradeList")}},Cs=xs,ks=(a("1053"),Object(re["a"])(Cs,ws,ys,!1,null,"e267eefe",null)),Ss=ks.exports,_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix",staticStyle:{padding:"0 20px"}},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.userName)+" 考试记录 "),a("div",{staticClass:"search-box-right",staticStyle:{"max-width":"100%"}},[a("el-date-picker",{staticStyle:{width:"240px","margin-right":"10px"},attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始考试","end-placeholder":"结束考试","value-format":"yyyyMMdd",size:"small"},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),a("el-input",{staticClass:"input-box",staticStyle:{width:"190px"},attrs:{placeholder:"请输入关键字查询",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")])],1)],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"0px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"60",fixed:""}}),a("el-table-column",{attrs:{prop:"examTime",label:"考试时间","show-overflow-tooltip":"",formatter:e.common.timeFormat}}),a("el-table-column",{attrs:{prop:"examName",label:"考试名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"score",label:"考试分数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"isPass",label:"考试状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"status",class:"status-"+t.row.isPass},[e._v(e._s(("1"==t.row.isPass?"合格":"不合格")||"--"))])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)])},Fs=[],Ls={props:{userid:String},data:function(){return{time:null,keyword:null,tableData:[],loading:!1,total:0,currentPage:1,pageSize:20,sort:null,orderBy:null,userName:sessionStorage.getItem("curRecordUserName")}},methods:{getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{userId:this.userid,starttime:this.time?this.time[0]+"000000":null,endtime:this.time?this.time[1]+"235959":null,keyword:this.keyword||null},limit:t,page:e||1};te(s).then((function(t){a.loading=!1,"000000"==t.code&&(a.tableData=t.data||[],a.total=t.total,a.currentPage=e||1)})).catch((function(e){a.loading=!1}))}},created:function(){this.getTableData(this.currentPage,this.pageSize)}},Ds=Ls,Ts=(a("0c37"),Object(re["a"])(Ds,_s,Fs,!1,null,"ddba6242",null)),js=Ts.exports,$s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"params"},[a("school"),a("div",{staticClass:"params-box"},[a("h3",[e._v("用户类型")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.userTypeLoading,expression:"userTypeLoading"}],staticClass:"params-box-content"},[e._l(e.userTypeList,(function(t){return a("div",{key:t.id,staticClass:"item show-item"},[e._v(e._s(t.name))])})),a("div",{staticClass:"item add-item",on:{click:e.asyncData}},[a("i",{staticClass:"el-icon-refresh"}),e._v(" 同步数据 ")])],2)]),a("div",{staticClass:"params-box"},[a("h3",[e._v("其他参数")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.otherLoading,expression:"otherLoading"}],staticClass:"params-box-content"},[a("label",[e._v("新生身份证登录：")]),a("div",{staticClass:"switch"},[a("el-switch",{attrs:{width:54,value:e.newbornLogin.val,"active-value":"1","inactive-value":"0"},on:{change:e.changeSwitch}}),"1"==e.newbornLogin.val?a("span",{staticClass:"on",on:{click:function(t){return e.changeSwitch(!1)}}},[e._v("开启")]):a("span",{staticClass:"off",on:{click:function(t){return e.changeSwitch(!0)}}},[e._v("关闭")])],1)])]),a("div",{staticClass:"params-box"},[a("h3",[e._v("全景导览地址配置")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qjdlLoading,expression:"qjdlLoading"}],staticClass:"params-box-content"},[a("label",[e._v("全景导览：")]),a("el-input",{class:{"is-error":!e.qjdlReg.test(e.qjdlEditVal)&&e.qjdlEditVal},staticStyle:{width:"300px","margin-right":"10px"},attrs:{placeholder:"请输入全景导览地址",size:"small"},model:{value:e.qjdlEditVal,callback:function(t){e.qjdlEditVal="string"===typeof t?t.trim():t},expression:"qjdlEditVal"}}),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.urlLoading,expression:"urlLoading"}],attrs:{type:"primary",size:"small",disabled:!(e.qjdlEditVal!=e.qjdl.val&&e.qjdlReg.test(e.qjdlEditVal)||!e.qjdlEditVal)},on:{click:e.saveQjdl}},[e._v("保存")])],1)])],1)},Is=[],zs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"params-box"},[a("h3",[e._v("校区管理")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.schoolLoading,expression:"schoolLoading"}],staticClass:"params-box-content"},[e._l(e.schoolList,(function(t,s){return a("div",{key:t.id,staticClass:"item"},[t.isEdit?a("div",{staticClass:"edit-item"},[a("el-input",{class:{"is-error":!t.editName&&e.activeSave},attrs:{placeholder:"请输入校区名称"},model:{value:t.editName,callback:function(a){e.$set(t,"editName",a)},expression:"item.editName"}}),a("div",{staticClass:"right-btn"},[a("span",{on:{click:function(a){return e.saveSchool(t)}}},[e._v("保存")]),a("span",{on:{click:function(a){return e.cancelEditSchool(t,s)}}},[e._v("取消")])])],1):a("div",{staticClass:"show-item"},[e._v(" "+e._s(t.name)+" "),a("div",{staticClass:"right-btn"},[a("span",{on:{click:function(e){t.isEdit=!0}}},[e._v("编辑")]),1!==t.isConfig?a("span",{on:{click:function(a){return e.deleteSchool(t)}}},[e._v("删除")]):e._e()])])])})),a("div",{staticClass:"item add-item",on:{click:e.addSchool}},[e._v("+ 新增校区")])],2)])},Ns=[],As={data:function(){return{schoolLoading:!1,schoolList:[],activeSave:!1}},methods:{addSchool:function(){this.schoolList.push({id:null,name:null,editName:null,isEdit:!0})},cancelEditSchool:function(e,t){this.activeSave=!1,e.id?(e.isEdit=!1,e.editName=e.name):this.schoolList.splice(t,1)},deleteSchool:function(e){var t=this;this.$confirm("确认删除校区『 ".concat(e.name," 』吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.schoolLoading=!0,Q(e.id).then((function(e){t.schoolLoading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"校区删除成功！"}),t.getSchoolList()):t.$message({showClose:!0,type:"error",message:"校区删除失败"+e.msg})})).catch((function(e){t.schoolLoading=!1,t.$message({showClose:!0,type:"error",message:"校区删除失败"+e})}))})).catch((function(e){}))},saveSchool:function(e){var t=this,a=e.id,s=e.name,i=e.editName;e.isEdit;if(this.activeSave=!0,i)if(i!=s){this.schoolLoading=!0;var o={id:a,name:i};G(o).then((function(e){t.schoolLoading=!1,t.activeSave=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"校区保存成功！"}),t.getSchoolList()):t.$message({showClose:!0,type:"error",message:"校区保存失败："+e.msg})})).catch((function(e){t.schoolLoading=!1,t.activeSave=!1,t.$message({showClose:!0,type:"error",message:"校区保存失败："+e})}))}else e.isEdit=!1},getSchoolList:function(){var e=this;this.schoolLoading=!0,this.$store.dispatch("getCampusList").then((function(t){e.schoolLoading=!1,e.schoolList=t,e.schoolList.forEach((function(t){e.$set(t,"isEdit",!1),e.$set(t,"editName",t.name)}))})).catch((function(t){e.schoolLoading=!1,e.schoolList=[],e.$message({showClose:!0,type:"error",message:"获取校区列表失败："+t})}))}},created:function(){this.getSchoolList()}},Ps=As,Os=(a("8093"),a("86d1"),Object(re["a"])(Ps,zs,Ns,!1,null,"393eb87b",null)),Es=Os.exports,Us={components:{school:Es},data:function(){return{userType:null,userTypeList:[{id:"1",name:"本科生"},{id:"2",name:"研究生"}],userTypeLoading:!1,otherLoading:!1,urlLoading:!1,qjdl:{},qjdlEditVal:null,qjdlLoading:!1,qjdlReg:/^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-~]+).)+([A-Za-z0-9-~\/])+$/}},computed:{newbornLogin:function(){return this.$store.state.newbornLogin}},methods:{getUserTypeList:function(){var e=this;this.userTypeLoading=!0,this.$store.dispatch("getUserTypeList").then((function(t){e.userTypeLoading=!1,e.userTypeList=t})).catch((function(t){e.userTypeLoading=!1,e.$message({showClose:!0,type:"error",message:"获取用户类型失败："+t})}))},asyncData:function(){var e=this;this.userTypeLoading=!0,V({}).then((function(t){e.userTypeLoading=!1,"000000"==t.code?e.getUserTypeList():e.$message({showClose:!0,type:"error",message:"数据同步失败："+t.msg})})).catch((function(t){e.userTypeLoading=!1,e.$message({showClose:!0,type:"error",message:"数据同步失败："+t})}))},getOhterParams:function(){var e=this;this.otherLoading=!0,H({}).then((function(t){if(e.otherLoading=!1,"000000"==t.code){var a=t.data||[],s=a.find((function(e){return"A2"==e.code}))||{};e.$store.commit("setNewbornLogin",s),e.qjdl=a.find((function(e){return"A1"==e.code}))||{},e.qjdlEditVal=e.qjdl.val||null}else e.$message({showClose:!0,type:"error",message:"获取其他参数失败："+t.msg})})).catch((function(t){e.otherLoading=!1,e.$message({showClose:!0,type:"error",message:"获取其他参数失败："+t})}))},saveQjdl:function(){var e=this;this.qjdlLoading=!0;var t="保存全景导览地址",a=Object(Ke["a"])({},this.qjdl);a.val=this.qjdlEditVal,this.saveParams(a,t,(function(){e.qjdl.val=e.qjdlEditVal}))},changeSwitch:function(e){var t=this;this.otherLoading=!0;var a="".concat(e?"开启":"关闭","新生身份证登录"),s=Object(Ke["a"])({},this.newbornLogin);s.val=e?"1":"0",this.saveParams(s,a,(function(){t.$store.commit("setNewbornLogin",s)}))},saveParams:function(e,t,a){var s=this;K(e).then((function(e){s.otherLoading=!1,s.qjdlLoading=!1,"000000"==e.code?(s.$message({showClose:!0,type:"success",message:"".concat(t,"成功！")}),a&&a()):s.$message({showClose:!0,type:"error",message:"".concat(t,"失败：").concat(e.msg)})})).catch((function(e){s.otherLoading=!1,s.qjdlLoading=!1,s.$message({showClose:!0,type:"error",message:"".concat(t,"失败：").concat(e)})}))}},created:function(){this.getUserTypeList(),this.getOhterParams()}},qs=Us,Rs=(a("64a2"),Object(re["a"])(qs,$s,Is,!1,null,null,null)),Ms=Rs.exports,Bs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix",staticStyle:{padding:"15px 20px 0"}},[a("h3",[e._v("模块管理")]),a("div",{staticClass:"search-box-right"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")])],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号","show-overflow-tooltip":"",width:"80"}}),a("el-table-column",{attrs:{prop:"name",label:"模块名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("el-input",{class:{"is-error":!t.row.editName},attrs:{size:"small"},model:{value:t.row.editName,callback:function(a){e.$set(t.row,"editName",a)},expression:"scope.row.editName"}}):a("span",{staticStyle:{color:"#606266"}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"排序",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.id?a("div",[0==t.$index?a("span",{staticClass:"disabled"},[a("i",{staticClass:"el-icon-top"}),e._v("上移 ")]):a("span",{on:{click:function(a){return e.move("up",t.row)}}},[a("i",{staticClass:"el-icon-top"}),e._v("上移 ")]),t.$index==e.total-1?a("span",{staticClass:"disabled"},[a("i",{staticClass:"el-icon-bottom"}),e._v("下移 ")]):a("span",{on:{click:function(a){return e.move("down",t.row)}}},[a("i",{staticClass:"el-icon-bottom"}),e._v("下移 ")])]):e._e()]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("div",[a("span",{on:{click:function(a){return a.stopPropagation(),e.editRow(t.row,!0)}}},[e._v("保存")]),a("span",{on:{click:function(a){return a.stopPropagation(),e.editRow(t.row,!1,t.$index)}}},[e._v("取消")])]):a("div",[a("span",{on:{click:function(e){t.row.isEdit=!0}}},[e._v("编辑")]),a("span",{on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")])])]}}])})],1)],1)])},Ys=[],Gs={data:function(){return{loading:!1,tableData:[],total:0}},methods:{addRow:function(){var e={id:null,name:null,editName:null,isEdit:!0};this.tableData.push(e)},editRow:function(e,t,a){if(t){if(!e.editName)return!1;if(e.name==e.editName)e.isEdit=!1;else{var s={id:e.id,name:e.editName};this.doSave(s)}}else e.isEdit=!1,e.editName=e.name,e.id||this.tableData.splice(a,1)},doSave:function(e){var t=this;this.loading=!0,q(e).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"保存成功！"}),t.getTableData()):t.$message({showClose:!0,type:"error",message:"保存失败：".concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"保存失败：".concat(e)})}))},deleteRow:function(e){var t=this;this.$confirm("是否确认删除模块『 ".concat(e.name," 』？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,R(e.id).then((function(e){t.loading=!1,"000000"==e.code?(t.$message({showClose:!0,type:"success",message:"删除成功！"}),t.getTableData()):t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e.msg)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e)})}))})).catch((function(){}))},move:function(e,t){var a=this,s="up"==e?M:B,i="up"==e?"模块上移":"模块下移";console.log(s,i),this.loading=!0,s({id:t.id}).then((function(e){a.loading=!1,"000000"==e.code?a.getTableData():a.$message({showClose:!0,type:"error",message:"".concat(i,"失败：").concat(e.msg)})})).catch((function(e){a.loading=!1,a.$message({showClose:!0,type:"error",message:"".concat(i,"失败：").concat(e)})}))},getTableData:function(){var e=this;this.loading=!0,this.$store.dispatch("getModuleList").then((function(t){e.loading=!1,e.tableData=t,e.tableData.forEach((function(t){e.$set(t,"isEdit",!1),e.$set(t,"editName",t.name)})),e.total=e.tableData.length})).catch((function(t){e.loading=!1,e.$message({showClose:!0,type:"error",message:"获取模块列表失败："+t})}))}},created:function(){this.getTableData()}},Qs=Gs,Vs=(a("1997"),a("d1e0"),Object(re["a"])(Qs,Bs,Ys,!1,null,"590a5484",null)),Js=Vs.exports,Hs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box clearfix"},[a("h3",[e._v("管理员管理")]),a("div",{staticClass:"search-box-right"},[a("el-button",{staticClass:"orange-btn",attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.openDrawer("add")}}},[e._v("新增")])],1)]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"NAME",label:"姓名"}}),a("el-table-column",{attrs:{prop:"LOGINNAME",label:"登录账号"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"more-span"},["local"==e.authType?a("span",{on:{click:function(a){return e.resetPwd(t.row)}}},[e._v("重置密码")]):e._e(),a("span",{on:{click:function(a){return e.deleteAccount(t.row)}}},[e._v("删除")])])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[5,10,15,20],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1),a("account-drawer",{ref:"accountDrawer",on:{doFunc:function(t){return e.getTableData(1,e.pageSize)}}}),a("third-drawer",{ref:"thirdDrawer",on:{doFunc:function(t){return e.getTableData(1,e.pageSize)}}})],1)},Ks=[],Xs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"base-drawer",attrs:{title:e.title,visible:e.drawer,direction:"rtl",wrapperClosable:!1,size:"660px"},on:{"update:visible":function(t){e.drawer=t},close:e.closeDrawer}},[a("div",{staticClass:"drawer-container"},[a("div",{staticClass:"tips"},[a("i",{staticClass:"el-icon-warning"}),a("span",[e._v("新增账号的默认登录密码为")]),a("span",{staticClass:"bold"},[e._v("123456")])]),a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"100px","show-message":!1,"label-position":"right"}},[a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"NAME",label:"姓名：",required:""}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入姓名",size:"small"},model:{value:e.editForm.NAME,callback:function(t){e.$set(e.editForm,"NAME",t)},expression:"editForm.NAME"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"LOGINNAME",label:"登录账号：",required:""}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入登录账号",size:"small"},model:{value:e.editForm.LOGINNAME,callback:function(t){e.$set(e.editForm,"LOGINNAME",t)},expression:"editForm.LOGINNAME"}})],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveAccount}},[e._v("保存")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawer=!1}}},[e._v("取消")])],1)])},Ws=[];function Zs(e){return P.postAjax({code:"auth",url:"rest/User/simpleList",data:e})}function ei(e){return P.postAjax({code:"auth",url:"rest/User/simpleSave",data:e})}function ti(e){return P.postAjax({code:"auth",url:"rest/User/saveUserPwd",data:e})}function ai(e){return P.postAjax({code:"url",url:"user/thirdAuthUserInfo",data:e})}var si={data:function(){return{title:"新增管理员",drawer:!1,drawerLoading:!1,editForm:{ID:null,NAME:null,LOGINNAME:null,PWD:"123456"}}},methods:{closeDrawer:function(){this.$refs.editForm.resetFields(),this.editForm={ID:null,NAME:null,LOGINNAME:null,PWD:"123456"}},saveAccount:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){e.drawerLoading=!0;var a={d:JSON.stringify(Object(Ke["a"])(Object(Ke["a"])({},e.editForm),{},{TID:e.$store.state.appId,ROLEID:e.$store.state.adminRoleId}))};ei(a).then((function(t){if(e.drawerLoading=!1,t.success)e.$message({showClose:!0,type:"success",message:"保存成功！"}),e.drawer=!1,e.$emit("doFunc");else{var a=t.data.message;a=a.replace(/LOGINNAME/g,"登录名"),e.$message({showClose:!0,type:"error",message:"保存失败："+a})}})).catch((function(t){e.drawerLoading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))}}},ii=si,oi=(a("5fe1"),Object(re["a"])(ii,Xs,Ws,!1,null,"30a9ce6a",null)),ni=oi.exports,ri=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"base-drawer",attrs:{title:e.title,visible:e.drawer,direction:"rtl",wrapperClosable:!1,size:"660px"},on:{"update:visible":function(t){e.drawer=t},close:e.closeDrawer}},[a("div",{staticClass:"drawer-container"},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"100px","show-message":!1,"label-position":"right"}},[a("el-form-item",{attrs:{label:"用户：",prop:"INFO",required:""}},[a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",remote:"",placeholder:"请输入工号查询",loading:e.userloading,"remote-method":e.debounceRemote,size:"small"},on:{change:function(t){return e.changeUser(t)}},model:{value:e.editForm.INFO,callback:function(t){e.$set(e.editForm,"INFO",t)},expression:"editForm.INFO"}},e._l(e.userList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"--"+e.id,value:JSON.stringify({ID:e.id,NAME:e.name})}})})),1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveAccount}},[e._v("保存")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.drawer=!1}}},[e._v("取消")])],1)])},li=[],ci={data:function(){return{title:"新增管理员",drawer:!1,drawerLoading:!1,userloading:!1,editForm:{INFO:null,ID:null,NAME:null,LOGINNAME:null,PWD:"123456"},userList:[]}},methods:{closeDrawer:function(){this.$refs.editForm.resetFields(),this.editForm={ID:null,NAME:null,LOGINNAME:null,PWD:"123456"}},saveAccount:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){e.drawerLoading=!0;var a=Object(Ke["a"])({},e.editForm);delete a.INFO;var s={d:JSON.stringify(Object(Ke["a"])(Object(Ke["a"])({},a),{},{TID:e.$store.state.appId,ROLEID:e.$store.state.adminRoleId}))};ei(s).then((function(t){if(e.drawerLoading=!1,t.success)e.$message({showClose:!0,type:"success",message:"保存成功！"}),e.drawer=!1,e.$emit("doFunc");else{var a=t.data.message;a=a.replace(/LOGINNAME/g,"登录名"),e.$message({showClose:!0,type:"error",message:"保存失败："+a})}})).catch((function(t){e.drawerLoading=!1,e.$message({showClose:!0,type:"error",message:"保存失败："+t})}))}}))},debounce:function(e,t){var a=null;return function(){var t=this;clearTimeout(a),a=setTimeout((function(){e.apply(t,arguments)}))}},debounceRemote:rs.debounce((function(e){this.remoteMethod(e)}),1e3),remoteMethod:function(e){var t=this;if(""!==e){this.userloading=!0;var a={readerid:e};ai(a).then((function(e){t.userloading=!1,"000000"==e.code?t.userList=e.data?[e.data]:[]:t.userList=[]})).catch((function(e){t.userloading=!1,t.userList=[]}))}else this.userList=[]},changeUser:function(e){var t=JSON.parse(e);this.editForm.NAME=t.NAME,this.editForm.LOGINNAME=t.ID}}},ui=ci,di=(a("a52e"),Object(re["a"])(ui,ri,li,!1,null,"05b9c618",null)),pi=di.exports,mi={components:{AccountDrawer:ni,ThirdDrawer:pi},data:function(){return{loading:!1,keyword:null,tableData:[],total:0,currentPage:1,pageSize:10,authType:window.g.authType}},methods:{openDrawer:function(e,t){var a="local"==this.authType?this.$refs.accountDrawer:this.$refs.thirdDrawer;"add"==e&&(a.title="新增管理员"),a.drawer=!0},getTableData:function(e,t){var a=this;this.loading=!0;var s={page:e||1,limit:t||this.pageSize,filter:JSON.stringify({STATUS:"1",ROLEID:this.$store.state.adminRoleId})};Zs(s).then((function(t){a.loading=!1,a.tableData=t.items||[],a.total=t.total,a.currentPage=e||1})).catch((function(e){a.loading=!1}))},deleteAccount:function(e){var t=this;this.$confirm("是否确认删除账号『 ".concat(e.NAME," 』？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a={d:JSON.stringify({ID:e.ID,STATUS:"0"})};ei(a).then((function(e){t.loading=!1,e.success?(t.$message({showClose:!0,type:"success",message:"删除成功！"}),t.getTableData()):t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e.data.errInf.shortBusInf)})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"删除失败：".concat(e)})}))})).catch((function(){}))},resetPwd:function(e){var t=this,a="确定重置用户『 ".concat(e.NAME," 』的密码吗？")+"\n系统默认登录密码为『 123456 』";this.$confirm("".concat(a),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var a={data:JSON.stringify({ID:e.ID,PWD:"123456"})};ti(a).then((function(e){t.loading=!1,e.success?t.$message({showClose:!0,type:"success",message:"重置密码成功！"}):t.$message({showClose:!0,type:"error",message:"重置密码失败："+e.data.message})})).catch((function(e){t.loading=!1,t.$message({showClose:!0,type:"error",message:"重置密码失败："+e})}))})).catch((function(){}))}},created:function(){this.getTableData(this.currentPage,this.pageSize)}},fi=mi,hi=(a("016a"),Object(re["a"])(fi,Hs,Ks,!1,null,"35c95e77",null)),gi=hi.exports,bi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box"},[a("el-select",{staticClass:"no-wrap",staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"是否必考",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.isImportant,callback:function(t){e.isImportant=t},expression:"isImportant"}},e._l(e.isImportantList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属模块",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.module,callback:function(t){e.module=t},expression:"module"}},e._l(e.moduleList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"所属校区",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.campus,callback:function(t){e.campus=t},expression:"campus"}},e._l(e.campusList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-select",{staticClass:"no-wrap",staticStyle:{width:"120px"},attrs:{multiple:"",size:"small",placeholder:"用户类型",clearable:""},on:{change:function(t){return e.getTableData(1,e.pageSize)}},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1),a("el-input",{staticClass:"input-box",staticStyle:{width:"160px"},attrs:{placeholder:"请输入题目内容",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")]),a("el-divider",{attrs:{direction:"vertical"}}),a("el-button",{staticClass:"bule-border",attrs:{size:"small"},on:{click:e.exportData}},[e._v("导出分析")])],1),a("div",{staticClass:"table-content"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.questionType,callback:function(t){e.questionType=t},expression:"questionType"}},e._l(e.questionTypeList,(function(e){return a("el-tab-pane",{key:e.value,attrs:{label:e.label,name:e.value}})})),1),a("div",{staticClass:"tab-box"},[a("span",[e._v("总计"+e._s(e.total)+"条")])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"},on:{"sort-change":e.sortBy}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"subject",label:"题目内容","show-overflow-tooltip":"",width:"500",fixed:""}}),a("el-table-column",{attrs:{prop:"modelNames",label:"所属模块","show-overflow-tooltip":"",width:"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"campusNames",label:"所属校区","show-overflow-tooltip":"",width:"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{prop:"usertypeNames",label:"所属用户类型","show-overflow-tooltip":"",width:"140",formatter:e.common.defaultFormat}}),a("el-table-column",{attrs:{sortable:"custom",prop:"answerNum",label:"被答次数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passNum",label:"正确次数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"unpassNum",label:"错误次数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passRate",label:"正确率","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.answerNum?e.common.multiply(t.row.passRate,100,2)+"%":"--")+" ")]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)])},vi=[],wi={data:function(){return{isImportant:null,isImportantList:[{id:1,name:"是"},{id:0,name:"否"}],module:[],campus:[],userType:[],keyword:null,questionType:"3",tableData:[],loading:!1,total:0,currentPage:1,pageSize:20,sort:null,orderBy:null}},computed:Object(O["b"])({moduleList:function(e){return e.moduleList},campusList:function(e){return e.campusList},userTypeList:function(e){return e.userTypeList},questionTypeList:function(e){return e.questionTypeList}}),methods:{exportData:function(){var e={};this.util.exportFile("analysisQuestion/exportAnalysis",!1,e,"导出分析","xlsx")},handleClick:function(e){this.getTableData(this.currentPage,this.pageSize)},sortBy:function(e){this.orderBy=e.prop,this.sort="ascending"==e.order?"asc":"desc",this.getTableData(1,this.pageSize)},getTableData:function(e,t){var a=this;this.loading=!0;var s={filter:{type:this.questionType||null,isImportant:[0,1].includes(this.isImportant)?this.isImportant:null,modelIds:this.module.join(",")||null,campusIds:this.campus.join(",")||null,usertypeCodes:this.userType.join(",")||null,subject:this.keyword||null},sort:this.sort||null,orderBy:this.orderBy||null,limit:t,page:e||1};Ua(s).then((function(t){a.loading=!1,"000000"==t.code&&(a.tableData=t.data||[],a.total=t.total,a.currentPage=e||1)})).catch((function(e){a.loading=!1}))}},created:function(){this.getTableData(this.currentPage,this.pageSize),0==this.moduleList.length&&this.$store.dispatch("getModuleList"),0==this.campusList.length&&this.$store.dispatch("getCampusList"),0==this.userTypeList.length&&this.$store.dispatch("getUserTypeList")}},yi=wi,xi=(a("ed1d"),Object(re["a"])(yi,bi,vi,!1,null,"4478afe2",null)),Ci=xi.exports,ki=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"analysis-exam"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.totalLoading,expression:"totalLoading"}],staticClass:"data-box"},[a("h3",[e._v("考试统计")]),a("div",{staticClass:"data-div"},[a("div",{staticClass:"data-item width-33"},[a("p",[e._v("考试人数")]),a("p",[a("countTo",{staticClass:"num",attrs:{startVal:0,endVal:e.totalnum,duration:1e3}})],1)]),a("div",{staticClass:"data-item width-33"},[a("p",[e._v("PC端考试")]),a("p",[a("countTo",{staticClass:"num",attrs:{startVal:0,endVal:e.pcnum,duration:1e3}}),a("span",[e._v("占比"+e._s(e.pcpercent)+"%")])],1)]),a("div",{staticClass:"data-item width-33"},[a("p",[e._v("移动端考试")]),a("p",[a("countTo",{staticClass:"num",attrs:{startVal:0,endVal:e.mobilenum,duration:1e3}}),a("span",[e._v("占比"+e._s(e.mobilepercent)+"%")])],1)])])]),a("div",{staticClass:"data-box"},[a("h3",[e._v("考试分析")]),a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"right-box"},[a("el-input",{staticClass:"input-box",staticStyle:{width:"160px","margin-right":"10px"},attrs:{placeholder:"请输入考试名称",size:"small",clearable:""},on:{clear:function(t){return e.getTableData(1,e.pageSize)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTableData(1,e.pageSize)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.getTableData(1,e.pageSize)}}},[e._v("查询")])],1),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"header-row-class-name":"table-header"},on:{"sort-change":e.sortBy}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"name",label:"题目内容","show-overflow-tooltip":"",width:"300",fixed:""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"answerNum",label:"考试人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passNum",label:"通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"unpassNum",label:"未通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passRate",label:"通过率","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.answerNum?e.common.multiply(t.row.passRate,100,2)+"%":"--"))]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.toDetail(t.row)}}},[e._v("查看")])]}}])})],1),e.total>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.total,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)])])])},Si=[],_i=a("ec1b"),Fi=a.n(_i),Li={components:{countTo:Fi.a},data:function(){return{totalLoading:!1,totalnum:0,pcnum:0,mobilenum:0,pcpercent:0,mobilepercent:0,keyword:null,tableData:[],tableLoading:!1,total:0,currentPage:1,pageSize:20,sort:null,orderBy:null}},methods:{calcData:function(e,t){var a=this.common.divide(e,t),s=this.common.multiply(a,100,2);return s},getTopData:function(){var e=this;this.totalLoading=!0,qa().then((function(t){if(e.totalLoading=!1,"000000"==t.code){var a=t.data||{};e.totalnum=a.totalnum||0,e.pcnum=a.pcnum||0,e.mobilenum=a.mobilenum||0,e.pcpercent=e.calcData(e.pcnum,e.totalnum),e.mobilepercent=e.calcData(e.mobilenum,e.totalnum)}})).catch((function(t){e.totalLoading=!1}))},toDetail:function(e){sessionStorage.setItem("cunAnalysisExamName",e.name),this.$router.push("/analysis/exam/".concat(e.id))},sortBy:function(e){this.orderBy=e.prop,this.sort="ascending"==e.order?"asc":"desc",this.getTableData(1,this.pageSize)},getTableData:function(e,t){var a=this;this.tableLoading=!0;var s={filter:{name:this.keyword||null},sort:this.sort||null,orderBy:this.orderBy||null,limit:t,page:e||1};Ra(s).then((function(i){if(a.tableLoading=!1,"000000"==i.code){a.tableData=i.data||[],a.total=i.total,a.currentPage=e||1;var o=Object(Ke["a"])(Object(Ke["a"])({},s.filter),{},{orderBy:a.orderBy,sort:a.sort,limit:t,page:e||1});sessionStorage.setItem("analysisExamParams",JSON.stringify(o))}})).catch((function(e){a.tableLoading=!1}))},initParams:function(){var e=sessionStorage.getItem("analysisExamParams");if(e){var t=JSON.parse(e),a=t.name,s=t.limit,i=t.page,o=t.sort,n=t.orderBy;this.keyword=a,this.pageSize=s,this.currentPage=i,this.sort=o,this.orderBy=n}}},created:function(){this.initParams(),this.getTopData(),this.getTableData(this.currentPage,this.pageSize)}},Di=Li,Ti=(a("6d5b"),Object(re["a"])(Di,ki,Si,!1,null,"56e688a8",null)),ji=Ti.exports,$i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"base-search-table"},[a("div",{staticClass:"search-box"},[a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),a("el-divider",{attrs:{direction:"vertical"}}),e._v(" "+e._s(e.examname)+" ")],1),a("div",{staticClass:"data-box"},[a("h3",[e._v("年级统计信息")]),a("div",{staticClass:"table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.gradeTableLoading,expression:"gradeTableLoading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.gradeTableData,"header-row-class-name":"table-header"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"grade",label:"年级","show-overflow-tooltip":"",width:"300",fixed:""}}),a("el-table-column",{attrs:{sortable:"",prop:"answerNum",label:"总人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"answerNum",label:"考试人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"passNum",label:"通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"unpassNum",label:"未通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"passRate",label:"通过率","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.answerNum?e.common.multiply(t.row.passRate,100,2)+"%":"--"))]}}])})],1)],1)]),a("div",{staticClass:"data-box"},[a("h3",[e._v("班级统计信息")]),a("div",{staticClass:"table-content"},[a("el-tabs",{on:{"tab-click":function(t){return e.getDeptTableData(1,e.pageSize)}},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},e._l(e.gradeList,(function(e){return a("el-tab-pane",{key:e,attrs:{label:e,name:e}})})),1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.deptTableLoading,expression:"deptTableLoading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.deptTableData,"header-row-class-name":"table-header"},on:{"sort-change":e.sortBy}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:""}}),a("el-table-column",{attrs:{prop:"dept",label:"所属","show-overflow-tooltip":"",width:"300",fixed:""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"answerNum",label:"总人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"answerNum",label:"考试人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passNum",label:"通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"unpassNum",label:"未通过人数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"custom",prop:"passRate",label:"通过率","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.answerNum?e.common.multiply(t.row.passRate,100,2)+"%":"--"))]}}])})],1),e.deptTotal>0?a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next",total:e.deptTotal,"page-size":e.pageSize,"page-sizes":[10,20,50,100],"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getTableData(t,e.pageSize)},"size-change":function(t){e.pageSize=t,e.getTableData(1,t)}}})],1):e._e()],1)])])},Ii=[],zi={props:{examid:String},data:function(){return{examname:sessionStorage.getItem("cunAnalysisExamName"),gradeTableData:[],gradeTableLoading:!1,gradeSort:null,gradeOrderBy:null,grade:null,deptTableData:[],deptTableLoading:!1,deptTotal:0,currentPage:1,pageSize:20,deptSort:null,deptOrderBy:null}},computed:Object(O["b"])({gradeList:function(e){return e.gradeList},deptList:function(e){return e.deptList}}),methods:{sortBy:function(e){this.orderBy=e.prop,this.sort="ascending"==e.order?"asc":"desc",this.getDeptTableData(1,this.pageSize)},getGradeTableData:function(){var e=this;this.gradeTableLoading=!0;var t={examId:this.examid};Ma(t).then((function(t){e.gradeTableLoading=!1,"000000"==t.code&&(e.gradeTableData=t.data||[])})).catch((function(t){e.gradeTableLoading=!1}))},getDeptTableData:function(e,t){var a=this;this.deptTableLoading=!0;var s={filter:{examId:this.examid,grade:this.grade},sort:this.sort||null,orderBy:this.orderBy||null,limit:t,page:e||1};Ba(s).then((function(t){a.deptTableLoading=!1,"000000"==t.code&&(a.deptTableData=t.data||[],a.deptTotal=t.total,a.currentPage=e||1)})).catch((function(e){a.deptTableLoading=!1}))},initDeptData:function(){this.grade=this.gradeList[0],this.getDeptTableData(this.currentPage,this.pageSize)}},created:function(){var e=this;this.getGradeTableData(),0==this.gradeList.length?this.$store.dispatch("getGradeList").then((function(){e.initDeptData()})):this.initDeptData()}},Ni=zi,Ai=(a("dd4d"),Object(re["a"])(Ni,$i,Ii,!1,null,"5eb84e90",null)),Pi=Ai.exports;i["default"].use(ue["a"]);var Oi=[{path:"*",component:Re},{path:"/no-right",name:"noRight",component:Ve},{path:"/",component:Te,children:[{path:"train",name:"train",component:mt},{path:"train/add",name:"trainAdd",component:Rt},{path:"train/edit/:id",name:"trainEdit",component:Rt,props:function(e){return{id:e.params.id}}},{path:"train/view/:type/:id",name:"trainDetail",component:Vt,props:function(e){return{id:e.params.id,type:e.params.type}}},{path:"question",name:"question",component:va,meta:{noBg:!0}},{path:"question/add",name:"questionAdd",component:Sa},{path:"question/edit/:id",name:"questionEdit",component:Sa,props:function(e){return{id:e.params.id}}},{path:"exam",name:"exam",component:Pa},{path:"exam/record",name:"examRecord",component:Va},{path:"exam/common-add",name:"examCommonAdd",component:ps},{path:"exam/common-edit/:id",name:"examCommonEdit",component:ps,props:function(e){return{id:e.params.id}}},{path:"exam/stage-add",name:"examStageAdd",component:vs},{path:"exam/stage-edit/:id",name:"examStageEdit",component:vs,props:function(e){return{id:e.params.id}}},{path:"sys-setting/users",name:"users",component:Ss},{path:"sys-setting/users/record/:userid",name:"userRecord",component:js,props:function(e){return{userid:e.params.userid}}},{path:"sys-setting/params",name:"params",component:Ms,meta:{noBg:!0}},{path:"sys-setting/modules",name:"modules",component:Js},{path:"sys-setting/admin",name:"admin",component:gi},{path:"analysis/question",name:"questionAnalysis",component:Ci,meta:{noBg:!0}},{path:"analysis/exam",name:"examAnalysis",component:ji,meta:{noBg:!0}},{path:"analysis/exam/:id",name:"examAnalysisDetail",component:Pi,meta:{noBg:!0},props:function(e){return{examid:e.params.id}}}]}],Ei=new ue["a"]({routes:Oi}),Ui=Ei,qi=(a("db4d"),a("1368")),Ri=a.n(qi),Mi=(a("9eee"),a("82da"),a("5c96")),Bi=a.n(Mi);a("34c4"),a("2ef0");Ri.a.polyfill(),i["default"].config.productionTip=!1,i["default"].use(Bi.a),i["default"].prototype.moment=os.a,i["default"].prototype.util=P,i["default"].prototype.common=rs,new i["default"]({router:Ui,store:ae,render:function(e){return e(ce)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";a("9c0c")},"5fe1":function(e,t,a){"use strict";a("d3d8")},"620c":function(e,t,a){},6419:function(e,t,a){"use strict";a("620c")},6441:function(e,t,a){},"64a2":function(e,t,a){"use strict";a("d29d")},"6d5b":function(e,t,a){"use strict";a("7bc8")},"6dd6":function(e,t,a){},"70c2":function(e,t,a){"use strict";a("bff6")},7125:function(e,t,a){e.exports=a.p+"static/img/noright.92ebff28.png"},7316:function(e,t,a){},"756a":function(e,t,a){},"7a0d":function(e,t,a){"use strict";a("e243")},"7bc8":function(e,t,a){},8093:function(e,t,a){"use strict";a("cd6f")},"823d":function(e,t,a){},"82da":function(e,t,a){},"85af":function(e,t,a){},8632:function(e,t,a){},"86d1":function(e,t,a){"use strict";a("144b")},"8fad":function(e,t,a){},"9c0c":function(e,t,a){},"9d51":function(e,t,a){"use strict";a("1129")},"9e48":function(e,t,a){"use strict";a("85af")},"9eee":function(e,t,a){},"9fef":function(e,t,a){"use strict";a("3814")},a1d2:function(e,t,a){"use strict";a("bf58")},a234:function(e,t,a){},a52e:function(e,t,a){"use strict";a("dbdc")},a599:function(e,t,a){},b0c3:function(e,t,a){"use strict";a("f81a")},b815:function(e,t,a){"use strict";a("8632")},be65:function(e,t,a){},bf58:function(e,t,a){},bff6:function(e,t,a){},c68f:function(e,t,a){"use strict";a("5641")},c9b9:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEqADAAQAAAABAAAAEAAAAADgaeE1AAABsElEQVQ4EY2UPUjDUBDH715raqW0k6sOWpcqYk0dLQiCu7oIOgv1Y3Z3c/EDQVcHF3XoLDg51RgR7WJxd3IotrRJm/MuWnipDfZBkvv43f8d7x1BCFmW9bQK6G0AwayPIDwCqQvTnLnqVYLdwXK5bNQbzUsgWu7O/QjizdBgbC2TyTh6XumO2PVGYz9URADewGfE1lagI8t6GQN034jozwZaDSCiBzQwYZpT7514oEApN/+fiBQKg+jMd0Tk63dUqVRi1erXCgM7BDSnA47zcxSGYehhLsQSd3acTCau0+l0E23bHm57dMfUZID8dUoPlr9bLmf2SkvsNaJwIep5cMBOTxGhPI+4b37C16RoKEaWwpn+MqLBhwat/vBwSjT41qgYjvSboaJKJZN7fHX3/ZZ0c1IrGlG+uipfe962nxc9aE8jYUzger2WMIxYUym1KX671T5zXdeIx+M18QmpqSDynM1O38qABiZbgM46PDl9YjshPkMDfpzgc3enkPXtrldgsvUcKthGohSP8Th3PEoEBkRgS2d0O7QjgY7Oz0fAcfm3gdWogvVCofChF+v2NybDmG+oYPNHAAAAAElFTkSuQmCC"},cd6f:function(e,t,a){},d1e0:function(e,t,a){"use strict";a("3b00")},d29d:function(e,t,a){},d3d8:function(e,t,a){},d4c1:function(e,t,a){"use strict";a("ea3f")},dbdc:function(e,t,a){},dd4d:function(e,t,a){"use strict";a("823d")},e243:function(e,t,a){},ea3f:function(e,t,a){},ed1d:function(e,t,a){"use strict";a("026d")},f357:function(e,t,a){"use strict";a("18c9")},f5a3:function(e,t,a){"use strict";a("a234")},f81a:function(e,t,a){},f824:function(e,t,a){},f9ec:function(e,t,a){"use strict";a("a599")},fa2e:function(e,t,a){}});